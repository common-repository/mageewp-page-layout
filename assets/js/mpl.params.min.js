!function(e){e().extend(mpl.params,{fields:{render:function(t,a,s){if("object"!=typeof a)return!1;for(var i,l,r,n=[],o=0,p=a.length;o<p;o++){if(i=a[o],l="",void 0!==s[i.name])l=s[i.name];else if(void 0!==i&&void 0!==i.value&&(l=i.value.toString()).indexOf("%time%")>-1){var c=new Date;l=l.replace("%time%",c.getTime())}"__empty__"==l&&(l=""),-1==mpl_param_types_support.indexOf(i.type)&&(i.type=""),r={value:l,options:void 0!==i.options?i.options:[],params:void 0!==i.params?i.params:[],sprite:i.sprite,name:i.name,type:i.type},"textarea_html"!=i.type&&(r.value=mpl.tools.unesc_attr(r.value));var m=mpl.template("field",{label:i.label,content:mpl.template("field-type-"+i.type,r),des:i.description,name:i.type,base:i.name,relation:i.relation});m=m.replace(/\&lt\;script/g,"<script").replace(/\&lt\;\/script\&gt\;/g,"<\/script>");var d=e(m);e(t).append(d),n.push([e.extend(!0,{},i),e.extend(!0,{},r),d,l])}setTimeout(function(t,a){for(var s,i,l,r,n=0,o=t.length;n<o;n++){if(s=t[n][0],i=t[n][1],l=t[n][2],r=t[n][3],void 0!==s.relation){var p=!1,c=s.relation;if(void 0!==c.parent&&(void 0!==c.show_when||void 0!==c.hide_when)){var m={};if(c.parent.indexOf(":")>-1){var d=c.parent.split(":")[0],u=c.parent.split(":")[1],f=a.closest(".mpl-params-popup"),g=f.find(".mpl-tab-general-"+d).data("tab");m=f.find("."+g).find(".field-base-"+u)}else m=a.find(">.field-base-"+c.parent);if(m.get(0)){if(void 0!==m.data("child"))(v=m.data("child"))[v.length]=l;else{var v=[];v[0]=l}m.data({child:v});var h=m.find('input.mpl-param[type="radio"],input.mpl-param[type="radio_image"],input.mpl-param[type="checkbox"],select.mpl-param');void 0!==c.show_when&&"object"!=typeof c.show_when&&(c.show_when=c.show_when.toString().split(",")),void 0!==c.hide_when&&"object"!=typeof c.hide_when&&(c.hide_when=c.hide_when.toString().split(",")),h.get(0)&&(p=!0,h.on("change",{el:l,std:r,show:c.show_when,hide:c.hide_when,iparent:h,parent:m},function(t){function a(e){e.forEach(function(e){e.addClass("relation-hidden"),e.find(".mpl-param").addClass("mpl-ns-param"),void 0!==e.data("child")&&a(e.data("child"))})}var s,i,l=t.data.iparent.serializeArray();void 0!==t.data.show&&(s=!1),void 0!==t.data.hide&&(i=!0);for(var r in l)void 0!==t.data.show&&t.data.show.indexOf(l[r].value)>-1&&(t.data.el.removeClass("relation-hidden"),t.data.el.find(".mpl-param").removeClass("mpl-ns-param"),t.data.el.hasClass("field-panel")||t.data.el.hasClass("field-mytabs")||t.data.el.hasClass("field-microwidgets")||t.data.el.find(".mpl-param:not(.mpl-empty-param)").each(function(){""===this.value&&("base64"==e(this).data("encode")&&(t.data.std=mpl.tools.base64.decode(t.data.std)),e(this).val(mpl.tools.unesc_attr(t.data.std)).change(),e(this).closest(".m-p-r-content").find(".mpl-attach-field-wrp .img-wrp").remove())}),s=!0),void 0!==t.data.hide&&t.data.hide.indexOf(l[r].value)>-1&&(t.data.el.addClass("relation-hidden"),t.data.el.find(".mpl-param").addClass("mpl-ns-param"),i=!1);void 0!==t.data.show&&!1===s&&(t.data.el.addClass("relation-hidden"),t.data.el.find(".mpl-param").addClass("mpl-ns-param")),void 0!==t.data.hide&&!0===i&&(t.data.el.removeClass("relation-hidden"),t.data.el.find(".mpl-param").removeClass("mpl-ns-param")),t.data.parent.hasClass("relation-hidden")&&(t.data.el.addClass("relation-hidden"),t.data.el.find(".mpl-param").addClass("mpl-ns-param")),void 0!==t.data.el.data("child")&&(t.data.el.hasClass("relation-hidden")?a(t.data.el.data("child")):t.data.el.find('input.mpl-param[type="radio"],input.mpl-param[type="checkbox"],select.mpl-param').trigger("change"))}).addClass("m-p-rela"),h.trigger("change"))}}!1===p&&(l.removeClass("relation-hidden"),l.find(".mpl-param").removeClass("mpl-ns-param"))}"function"==typeof i.callback&&i.callback(l,e,i)}delete t},1,n,t)},tabs:function(t,a){a.addClass("fields-edit-form");var s=e(t).closest(".m-p-wrap").find(".m-p-body").find(">."+e(t).data("tab")),i=(e(t).closest(".m-p-wrap").find(".m-p-body").find(">.fields-edit-form"),e(t).data("cfg").split("|")),l={},r={};return l=e().extend({},mpl.tools.popup.storage),r=e().extend({},mpl.tools.popup.params),mpl.params.fields.render(s,r.params[i[0]],l),e(t).data("callback",function(e,t){}),s}}}),e().extend(mpl.params.fields,{radiotabs:{callback:function(e){this.el=e,mpl.trigger(this)},events:{".mpl-radiotabs-rows:click":"actions"},actions:function(t){var a=e(t.target);if(a.data("action")){e(this).closest(".mpl-param-row.field-radiotabs");switch(a.data("action")){case"collapse":t.data.collapse(a)}}},collapse:function(e){var t=e.closest(".mpl-radiotabs-row");t.hasClass("active")?t.removeClass("active"):(e.closest(".mpl-radiotabs-rows").find(".mpl-radiotabs-row.active").removeClass("active"),t.addClass("active"))},set_index:function(t,a,s){for(var i=[],l=0;l<t.length;l++)"radiotabs"!=t[l].type&&(i[i.length]=e().extend({},t[l]),-1==t[l].name.indexOf(a+"[")&&(i[i.length-1].name=a+"["+s+"]["+t[l].name+"]"));return i}}}),e().extend(mpl.params.fields,{mytabs:{callback:function(e){this.el=e},set_index:function(t,a,s){for(var i=[],l=0;l<t.length;l++)"mytabs"!=t[l].type&&(i[i.length]=e().extend({},t[l]),-1==t[l].name.indexOf(a+"[")&&(i[i.length-1].name=a+"["+s+"]["+t[l].name+"]"));return i}}}),e().extend(mpl.params.fields,{microwidgets:{callback:function(e){this.el=e,mpl.trigger(this),e.find(".mpl-widgets-row").first().addClass("active"),this.sortable()},events:{".mpl-widgets-rows:click":"actions",".mpl-add-widgets:click":"add_widget"},actions:function(t){var a=e(t.target);if(a.data("action")){var s=e(this).closest(".mpl-param-row.field-widgets");switch(a.data("action")){case"collapse":t.data.collapse(a);break;case"delete":t.data.remove(a,t.data,s)}}a.hasClass("mpl-add-widgets")||!a.hasClass("mpl-widgets-controls")&&!a.hasClass("counter")||t.data.collapse(a)},collapse:function(e){var t=e.closest(".mpl-widgets-row");t.hasClass("active")?t.removeClass("active"):(e.closest(".mpl-widgets-rows").find(".mpl-widgets-row.active").removeClass("active"),t.addClass("active"))},remove:function(e,t,a){confirm("Are you sure that you want to delete this item?")&&e.closest(".mpl-widgets-row").remove()},add_widget:function(t){var a=e(this).closest(".mpl-param-row.field-microwidgets"),s=e(mpl.template("param-microwidgets")),i="",l=mpl.tools.popup.render(this,{title:"Add MicroWidgets",class:"mpl-box-settings-popup mpl-box-subPop",width:400,scrollBack:!1,scrollTo:!1,float:!1,footer:!1,keepCurrentPopups:!0,drag:!1});l.data({target:this,event:t,cancel:function(e){}});var r=e(this).closest(".mpl-widgets-rows").find(".mpl-param").serializeArray(),n={};e.map(r,function(e,t){void 0!=e.name&&(n[e.name]=e.value)}),i='<div class="mpl-microwidgets">',i+='<ul class="mpl-microwidgets-list-main mpl-microwidgets-list">';for(var o in a.data("params"))i+='<li title="" data-support="" data-rule="" class="mpl-element-item mcpn-banner">',i+="<div>",i+='<i class="cpicon mpl-icon-banner" aria-hidden="true"></i>',i+='<span class="cpdes">',i+="<strong>"+o+"</strong>",i+="</span>",i+="</div>",i+="</li>";i+="</ul>",(i=e(i+="</div>")).on("click",function(t){if("STRONG"==t.target.tagName){var i=mpl.get.popup(this).data("target"),l=mpl.params.fields.microwidgets.set_index(a.data("params")[t.target.textContent],a.data("name"),t.target.textContent);s.find("li.counter").html(t.target.textContent),e(i).before(s),mpl.params.fields.render(s.find(".mpl-widgets-body"),l,{});var r=mpl.get.popup(this).data("event");r.data.collapse(s.find("li.mpl-collapse")),r.data.sortable(),mpl.get.popup(this,"close").trigger("click")}}),l.find(".m-p-body").append(i),t.preventDefault()},set_index:function(t,a,s){for(var i=[],l=0;l<t.length;l++)"microwidgets"!=t[l].type&&(i[i.length]=e().extend({},t[l]),-1==t[l].name.indexOf(a+"[")&&(i[i.length-1].name=a+"["+s+"]["+t[l].name+"]"));return i},sortable:function(){mpl.ui.sortable({items:"div.mpl-widgets-rows>div.mpl-widgets-row",handle:">.mpl-widgets-controls",helper:["mpl-ui-handle-image",25,25],connecting:!1,vertical:!0})}}}),e().extend(mpl.params.fields,{group:{callback:function(e){this.el=e,mpl.trigger(this),e.find(".mpl-group-row").first().addClass("active"),this.re_index(e),this.sortable()},events:{".mpl-group-rows:click":"actions",".mpl-add-group:click":"add_group"},actions:function(t){var a=e(t.target);if(a.data("action")){var s=e(this).closest(".mpl-param-row.field-group");switch(a.data("action")){case"collapse":t.data.collapse(a);break;case"delete":t.data.remove(a,t.data,s);break;case"double":t.data.double(a,t.data,s)}}a.hasClass("mpl-add-group")||!a.hasClass("mpl-group-controls")&&!a.hasClass("counter")||t.data.collapse(a)},collapse:function(e){var t=e.closest(".mpl-group-row");t.hasClass("active")?t.removeClass("active"):(e.closest(".mpl-group-rows").find(".mpl-group-row.active").removeClass("active"),t.addClass("active"))},remove:function(e,t,a){confirm("Are you sure that you want to delete this item?")&&(e.closest(".mpl-group-row").remove(),t.re_index(a))},double:function(t,a,s){var i=t.closest(".mpl-group-row"),l=i.find(".mpl-param").serializeArray(),r={},n=e(mpl.template("param-group")),o=i.find(".mpl-param").get(0).name;o=o.substring(o.indexOf("[")+1,o.indexOf("]")),params=mpl.params.fields.group.set_index(s.data("params"),s.data("name"),o),i.after(n),e.map(l,function(e,t){void 0!=e.name&&(r[e.name]=e.value)}),mpl.params.fields.render(n.find(".mpl-group-body"),params,r),mpl.params.fields.group.re_index(s),a.collapse(n.find("li.mpl-collapse")),a.sortable()},add_group:function(t){var a=e(this).closest(".mpl-param-row.field-group"),s=e(mpl.template("param-group"));e(this).before(s);var i=mpl.params.fields.group.set_index(a.data("params"),a.data("name"),0);mpl.params.fields.render(s.find(".mpl-group-body"),i,{}),mpl.params.fields.group.re_index(a),t.data.collapse(s.find("li.mpl-collapse")),t.data.sortable()},set_index:function(t,a,s){for(var i=[],l=0;l<t.length;l++)"group"!=t[l].type&&(i[i.length]=e().extend({},t[l]),-1==t[l].name.indexOf(a+"[")&&(i[i.length-1].name=a+"["+s+"]["+t[l].name+"]"));return i},re_index:function(t){var a=1;t.find(".mpl-group-row").each(function(){e(this).find("input.mpl-param, select.mpl-param, textarea.mpl-param").each(function(){if(this.name.indexOf("[")>-1){var e=this.name.substring(0,this.name.indexOf("[")+1);e+=a,e+=this.name.substr(this.name.indexOf("]")),this.name=e}this.label=this.name.substr(this.name.indexOf("][")+2).replace("]","")});var t=e(this).find(".mpl-param-row").first().find("input.mpl-param, select.mpl-param, textarea.mpl-param");1!==t.data("added-change")&&(t.data({"added-change":1}),t.on("change",function(){var t=e(this).closest(".mpl-group-row").find("li.counter"),a=this.value;if(/^http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?$/i.test(this.value))var s=new Array,i=(s=(s=a.split("/"))[s.length-1].split("?"))[0];else i=mpl.tools.esc(this.value);var l=e(this).closest(".mpl-group-row").data("tab");l?e(this).closest(".mpl-group-rows").find('li[data-tab="'+l+'"]').html(i):t.html(this.label+": "+i)}));var s=t.serializeArray();if(void 0!==s[0]){var i=s[0].value;if(/^http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?$/i.test(i))var l=new Array,r=(l=(l=i.split("/"))[l.length-1].split("?"))[0];else r=mpl.tools.esc(s[0].value);var n=e(this).closest(".mpl-group-row").data("tab");n?e(this).closest(".mpl-group-rows").find('li[data-tab="'+n+'"]').html(r):e(this).find("li.counter").html(t.get(0).label+": "+r)}a++})},sortable:function(){mpl.ui.sortable({items:"div.mpl-group-rows>div.mpl-group-row",handle:">.mpl-group-controls",helper:["mpl-ui-handle-image",25,25],connecting:!1,vertical:!0,end:function(t,a){mpl.params.fields.group.re_index(e(a).closest(".mpl-param-row.field-group"))}})}}}),e().extend(mpl.params.fields,{css:{screens:{},fields:{undefined:"text","font-family":"css_family","font-size":{type:"number",options:{units:["px","em","%"]}},"font-weight":{type:"select_group",options:{custom:!0,tooltip:!0,buttons:{"":'<i class="fa-ban"></i>',300:"300",400:"400",500:"500",600:"600",700:"700",800:"<strong>800</strong>"}}},"font-style":{type:"select_group",options:{custom:!0,tooltip:!0,buttons:{normal:'<i class="fa-ban"></i>',italic:'<i style="font-style:italic;font-family:serif">I</i>'}}},"text-align":{type:"select_group",options:{custom:!0,tooltip:!0,buttons:{"":'<i class="fa-ban"></i>',left:'<i class="fa-align-left"></i>',center:'<i class="fa-align-center"></i>',right:'<i class="fa-align-right"></i>',justify:'<i class="fa-align-justify"></i>'}}},"text-transform":{type:"select_group",options:{custom:!0,tooltip:!0,buttons:{none:'<i class="fa-ban"></i>',uppercase:"TT",capitalize:"Tt",lowercase:"tt"}}},"text-decoration":{type:"select_group",options:{custom:!0,tooltip:!0,buttons:{none:'<i class="fa-ban"></i>',underline:"<u>T</u>","line-through":'<span style="text-decoration: line-through">T</span>'}}},"line-height":{type:"number",options:{units:["px","em","%"]}},"letter-spacing":{type:"number",options:{units:["px","em","%"]}},overflow:{type:"select",options:{"":"=== Select ===",auto:"Auto",hidden:"Hidden",inherit:"Inherit",initial:"Initial",overlay:"Overlay",scroll:"Scroll",visible:"Visible"}},"word-break":{type:"select",options:{"":"=== Select ===","break-all":"Break All","break-word":"Break Word",inherit:"Inherit",initial:"Initial",normal:"Normal"}},color:"color_picker","background-color":"color_picker","border-color":"color_picker","border-top-color":"color_picker","border-right-color":"color_picker","border-bottom-color":"color_picker","border-left-color":"color_picker","border-style":{type:"select",options:{none:"None",solid:"Solid",dotted:"Dotted",dashed:"Dashed",double:"Double",groove:"Groove",ridge:"Ridge",inset:"Inset",outset:"Outset",initial:"Initial",inherit:"Inherit"}},"align-items":{type:"select",options:{"":"=== Select ===",inherit:"Inherit",baseline:"Baseline",center:"Center","flex-end":"Flex-end","flex-start":"Flex-start",initial:"Tnitial",stretch:"Stretch"}},"border-width":{type:"number",options:{units:["px","em","%"]}},background:{type:"css_background",label:""},"video-background":{type:"css_video_background",label:""},width:{type:"number",options:{units:["px","em","%"]}},height:{type:"number",options:{units:["px","em","%"]}},margin:{type:"corners",options:{"margin-top":"Top","margin-right":"Right","margin-bottom":"Bottom","margin-left":"Left"},des:"Drag on input to change the value, double click to remove value"},"margin-right":{type:"number",options:{units:["px","em"]}},padding:{type:"corners",options:{"padding-top":"Top","padding-right":"Right","padding-bottom":"Bottom","padding-left":"Left"},des:"Drag on input to change the value, double click to remove value"},border:"css_border","border-radius":{type:"corners",options:{"border-top-left-radius":"Top Left","border-top-right-radius":"Top Right","border-bottom-right-radius":"Bottom Right","border-bottom-left-radius":"Bottom Left"}},float:{type:"select_group",options:{custom:!0,tooltip:!0,buttons:{"":'<i class="fa-ban"></i>',left:"Left",right:"Right",inherit:"Inherit",initial:"Initial",none:"None"}}},display:{type:"select_group",options:{custom:!0,tooltip:!0,buttons:{"":'<i class="fa-ban"></i>',"inline-block":"IB",inline:"Inline",block:"Block",flex:"Flex",none:"None"}}},cursor:{type:"select_group",options:{custom:!0,tooltip:!0,buttons:{"":'<i class="fa-ban"></i>',pointer:"Pointer",default:"Default",text:"Text",help:"Help"}}},opacity:{type:"number_slider",options:{min:0,max:100,ratio:.01},value:""},"box-shadow":"text","text-shadow":"text",gap:{type:"number",options:{units:["px","em"]}},"max-width":{type:"number",options:{units:["px","em","%"]}},custom:{type:"custom",des:"<ul><li>- Click outside of the textarea to apply changes.</li><li>- This has a higher priority than the visual selection</li></ul>"}},remap:function(e){this.screens={};for(var t=0;t<e.length;t++)this.remap_screen(e[t]);return this.screens},remap_screen:function(t){var a,s,i,l,r,n,o,p=["any"];void 0!==t.screens&&(p=t.screens.split(","));for(i in t)if("screens"!=i)for(l=0;l<t[i].length;l++)if(void 0!==t[i][l].property){n=t[i][l].property.replace(/\ /g,"").split(","),labels=void 0!==t[i][l].label?t[i][l].label.split(","):[];for(o in n)for(void 0!==labels[o]?t[i][l].label=labels[o]:t[i][l].label=n[o].replace(/\-/g," ").replace(/\_/g," "),a=n[o]+"|",void 0!==t[i][l].selector&&""!==t[i][l].selector&&(a+=t[i][l].selector),s=0;s<p.length;s++)r=p[s].trim(),void 0===this.screens[r]&&(this.screens[r]={}),void 0===this.screens[r][i]&&(this.screens[r][i]={}),this.screens[r][i][a]=e.extend({},t[i][l])}},render:function(t,a){var s,i,l,r=this.remap(t.options),n=e('<ul class="mpl-css-screens-nav"></ul>'),o=Object.keys(r).sort(function(e,t){return parseInt(e,10)<parseInt(t,10)});try{l=JSON.parse(t.value.replace(/(?:\r\n|\r|\n)/g,"").replace(/\`/g,'"')),l=void 0===l["mpl-css"]||"object"!=typeof l["mpl-css"]?{}:l["mpl-css"]}catch(e){l={}}for(s=0;s<o.length;s++)i=e('<li data-screen="'+o[s]+'">'+this.responsive_icon(o[s])+"</li>"),"any"==o[s]?n.prepend(i):n.append(i),i.data("predatas",[r[o[s]],a.get(0),o[s],void 0!==l[o[s]]?l[o[s]]:{}]);1===o.length&&"any"==o[0]&&n.addClass("mpl-css-hidden"),a.prepend(n),a.css({"min-height":""}),mpl.trigger({el:a,events:{click:"click",".mpl-css-screens-nav li:click":"screen_tabs"},click:function(t){if("mpl-css-important"==t.target.className){var a=e(t.target).closest(".mpl-param-row");a.hasClass("is-important")?a.removeClass("is-important"):a.addClass("is-important"),e(t.target).parent().find(".mpl-css-param").trigger("change")}},screen_tabs:function(t){var a=e(this),s=a.data("screen"),i=a.data("predatas");null!==i&&(mpl.params.fields.css.render_groups(i[0],e(i[1]),i[2],i[3]),a.data("predatas",null)),a.parent().find(">li.active").removeClass("active"),a.addClass("active");var l=a.closest(".mpl-css-rows").find(".mpl-css-screen");l.addClass("mpl-css-hidden"),l.filter(".mpl-css-screen-"+s).removeClass("mpl-css-hidden")}});var p=e("body").data("screen-size");e("#mpl-top-toolbar li.active").length>0&&(p=e("#mpl-top-toolbar li.active").data("screen")),"100%"==p?p="any":"768"==p&&(p="999"),void 0!==p&&n.find('li[data-screen="'+p+'"]').length>0?n.find('li[data-screen="'+p+'"]').trigger("click"):a.find(".mpl-css-screens-nav li").first().trigger("click")},render_groups:function(t,a,s,i){var l,r,n,o,p,c,m,d,u=e('<div data-screen="'+s+'" class="mpl-css-screen mpl-css-hidden mpl-css-screen-'+s+'"></div>'),f=e('<ul class="mpl-css-group-nav"></ul>'),g=Object.keys(t);for(o in g)f.append("<li>"+g[o].replace(/\_/g," ")+"</li>");"any"==s?f.append('<li class="right">any screens</li>'):s.indexOf("-")>-1?f.append('<li class="right">screen '+s.replace("-","=>")+"</li>"):f.append('<li class="right">screen Max '+s+"px</li>"),u.append(f),g.length<=1&&f.addClass("mpl-css-hidden");for(d in t)for(o in t[d]){r="",m=!1,p=(l=o.split("|")[0]).replace(/\-/g," "),atts=mpl.params.fields.css.fields[l],void 0===atts&&(console.error("MPL: The css property "+l+" is not defined."),atts=mpl.params.fields.css.fields.undefined),c=void 0!==i[mpl.tools.esc_slug(d)]&&void 0!==i[mpl.tools.esc_slug(d)][o]?i[mpl.tools.esc_slug(d)][o]:void 0!==t[d][o].value?t[d][o].value:void 0!==atts.value?atts.value:"",void 0===atts?(n="underfined",atts=[]):"string"==typeof atts?n=atts:void 0!==atts.type?n=atts.type:void 0===atts.type&&(n="text"),void 0!==atts.label&&(p=atts.label),void 0!==t[d][o].label&&(p=t[d][o].label),void 0!==atts.des&&(r=atts.des),void 0!==t[d][o].des&&(r=t[d][o].des),-1==mpl_param_types_support.indexOf(n)&&(n="text"),c.toString().indexOf("!important")>-1&&(c=c.replace("!important","").trim(),m=!0),"custom"==n&&(c=c.replace(/\;/g,";\n")),atts={value:c,options:void 0!==atts.options?atts.options:[],params:[],name:"mpl-css["+s+"]["+mpl.tools.esc_slug(d)+"]["+o+"]",type:n,label:p},"textarea_html"!=n&&(atts.value=mpl.tools.unesc_attr(atts.value));var v=mpl.template("field",{label:p,content:mpl.template("field-type-"+n,atts),name:n,des:r,base:o});v=v.replace(/\&lt\;script/g,"<script").replace(/\&lt\;\/script\&gt\;/g,"<\/script>").replace(/mpl\-param\"/g,'mpl-css-param"').replace(/mpl\-param /g,"mpl-css-param ");var h=e(v);if(u.append(h),!0===m&&h.addClass("is-important"),h.addClass("mpl-css-group-"+mpl.tools.esc_slug(d)+" mpl-css-hidden").attr({"data-name":o.replace(/\"/g,"")}).append('<span class="mpl-css-important" title="Important"></span>'),"function"==typeof atts.callback&&setTimeout(atts.callback,1,h,e,atts),void 0!=t[d][o].refer)for(rf in t[d][o].refer){var _=t[d][o].refer[rf].property+"|"+t[d][o].refer[rf].selector;atts={value:_,options:void 0!==atts.options?atts.options:[],params:[],name:"mpl-css["+s+"]["+mpl.tools.esc_slug(d)+"]["+o+"]",type:"hidden",label:""};var b=mpl.template("field-type-hidden",atts);b=b.replace(/\&lt\;script/g,"<script").replace(/\&lt\;\/script\&gt\;/g,"<\/script>").replace(/mpl\-param\"/g,'mpl-css-refer"').replace(/mpl\-param /g,"mpl-css-refer");var w=e(b);u.append(w)}}a.append(u),u.find(".mpl-css-group-nav li").on("click",function(t){var a=e(this),s=a.closest(".mpl-css-screen").find(">.mpl-param-row");slug=mpl.tools.esc_slug(a.html()),a.hasClass("right")||(a.parent().find(">li.active").removeClass("active"),a.addClass("active"),s.addClass("mpl-css-hidden"),s.filter(".mpl-css-group-"+slug).removeClass("mpl-css-hidden"))}).first().trigger("click"),mpl.do_action("mpl-css-field-change",a,a.closest(".mpl-params-popup")),delete o},responsive_icon:function(e){return"any"==e?'<i class="fa-desktop"></i>':(e=parseInt(e,10))<480?'<i class="fa-mobile"></i>':e<768?'<i style="transform:rotate(90deg)" class="fa-mobile"></i>':e<1e3?'<i class="fa-tablet"></i>':e<1025?'<i style="transform:rotate(90deg)" class="fa-tablet"></i>':'<i class="fa-desktop"></i>'},save_fields:function(t){t.find(".mpl-param-row.field-css").each(function(){e(this).find(".mpl-field-css-value").val(mpl.params.fields.css.field_values(this))});try{delete mpl.storage[t.data("model")].args.css}catch(e){}},field_values:function(t){var a=e(t).find(".mpl-field-css-value"),s=this.get_fields(e(t),!0),i=a.val();try{void 0===(i=JSON.parse(i.replace(/(?:\r\n|\r|\n)/g,"").replace(/\`/g,'"')))["mpl-css"]&&(i={"mpl-css":{}})}catch(e){i={"mpl-css":{}}}if(void 0!==s["mpl-css"]){for(var l in s["mpl-css"])i["mpl-css"][l]=s["mpl-css"][l];return i=mpl.params.fields.css.sort_screens(i),i=JSON.stringify(i).replace(/\"/g,"`")}return""},get_fields:function(t,a){var s,i,l,r,n,o={},p=t.find(".mpl-css-param").serializeArray(),c=t.find(".mpl-css-refer").serializeArray(),m=mpl.tools.reIndexForm(p,[]),d=mpl.tools.reIndexForm(c,[]);t.find(".mpl-param-row.is-important").each(function(){o[e(this).find(".mpl-css-param").attr("name")]=!0});for(s in m["mpl-css"])if("object"==typeof m["mpl-css"][s]){for(i in m["mpl-css"][s]){if("object"==typeof m["mpl-css"][s][i])for(l in m["mpl-css"][s][i])if(m["mpl-css"][s][i][l]=m["mpl-css"][s][i][l].toString().replace(/(?:\r\n|\r|\n)/g,"").replace(/\`/g,""),""===m["mpl-css"][s][i][l]?delete m["mpl-css"][s][i][l]:!0===o["mpl-css["+s+"]["+i+"]["+l+"]"]&&""!==m["mpl-css"][s][i][l]&&(m["mpl-css"][s][i][l]=m["mpl-css"][s][i][l]+" !important"),""!=m["mpl-css"][s][i][l]&&"object"==typeof d["mpl-css"]&&"object"==typeof d["mpl-css"][s]&&"object"==typeof d["mpl-css"][s][i]&&"string"==typeof d["mpl-css"][s][i][l]){n=d["mpl-css"][s][i][l].split(",");for(r in n)m["mpl-css"][s][i][n[r]]=m["mpl-css"][s][i][l]}0===Object.keys(m["mpl-css"][s][i]).length&&delete m["mpl-css"][s][i]}0===Object.keys(m["mpl-css"][s]).length&&delete m["mpl-css"][s]}else""===m["mpl-css"][s]&&delete m["mpl-css"][s];return Object.keys(m["mpl-css"]).length>0?!0===a?m:JSON.stringify(m).replace(/\"/g,"`"):""},sort_screens:function(e){var t,a,s,i,l=[],r={"mpl-css":{}};for(t in e["mpl-css"])"any"==t?r["mpl-css"].any=e["mpl-css"].any:l.push(parseInt(t,10));for(a=0;a<l.length;a++)for(s=a+1;s<l.length;s++)l[a]<l[s]&&(i=l[s],l[s]=l[a],l[a]=i);for(t in l)r["mpl-css"][l[t].toString()]=e["mpl-css"][l[t].toString()];return r}}}),e().extend(mpl.params,{admin_label:{render:function(e){var t="",a="";if(void 0!==e.map.admin_view&&("function"==typeof window[e.map.admin_view]?a=window[e.map.admin_view](e.params.args,e.el):"function"==typeof mpl.params.admin_view[e.map.admin_view]?a=mpl.params.admin_view[e.map.admin_view](e.params.args,e.el):console.log('MPL Error: the admin_view function "'+e.map.admin_view+'" is undefined'),""!==a))return'<div class="admin-view custom-admin-view '+e.map.admin_view+'">'+a+"</div>";var s=mpl.params.merge(e.map.params),i=e.params,l=mpl.params.admin_label;for(var r in s)a="","image"==s[r].name&&void 0===i.args[s[r].name]&&(i.args[s[r].name]=""),!0===s[r].admin_label&&void 0!==i.args[s[r].name]&&"__empty__"!=i.args[s[r].name]&&("function"==typeof l[s[r].type]?a=l[s[r].type](i.args[s[r].name],s[r].label,e.el):(a='<span class="admin-view-label"><strong>'+s[r].name+"</strong></span> : ",a+=mpl.tools.unesc_attr(i.args[s[r].name])),""!==a&&(t+='<div class="admin-view '+s[r].name+'" data-name="'+s[r].name+'">'+a+"</div>"));return t},update:function(){clearTimeout(this.timer),this.timer=setTimeout(function(t){var a=e(t).data("name").trim(),s=mpl.get.model(t);void 0!==mpl.storage[s]&&(mpl.storage[s].args[a]=t.innerHTML,"content"==a&&(mpl.storage[s].content=t.innerHTML),mpl.confirm(!0))},500,this)},attach_image:function(e){return'<img src="'+mpl_ajax_url+"?action=mpl_get_thumbn&id="+e+'" />'},attach_images:function(e){if(void 0===e||""===e)return'<img src="'+mpl_ajax_url+'?action=mpl_get_thumbn&id=undefined" />';var t="";return e.split(",").forEach(function(e){t+='<img src="'+mpl_ajax_url+"?action=mpl_get_thumbn&id="+e+'&size=thumbnail" />'}),t},textarea_html:function(e){return e},editor:function(e){return mpl.tools.base64.decode(e)},textarea:function(e,t){var a=mpl.tools.esc(mpl.tools.base64.decode(e.replace(/(?:\r\n|\r|\n)/g,""))).toString();return(a='<span class="admin-view-label"><strong>'+t+" : </strong></span>"+a).length<350?a:a.substr(0,347)+"..."},mpl_box:function(e){function t(e){if(void 0===e||null===e)return"";var a="";return e.forEach(function(e){if("text"!=e.tag){a+="<"+e.tag,"object"!=typeof e.attributes&&(e.attributes={}),"column"==e.tag?e.attributes.class+=" "+e.attributes.cols:"img"==e.tag&&(void 0!==e.attributes.src&&""!==e.attributes.src||(e.attributes.src=mpl_plugin_url+"/assets/images/get_start.jpg"));for(var s in e.attributes)a+=" "+s+'="'+e.attributes[s]+'"';"img"==e.tag&&(a+="/"),a+=">","object"==typeof e.children&&(a+=t(e.children)),"img"!=e.tag&&(a+="</"+e.tag+">")}else a+=e.content}),a}var a;try{e=(e=mpl.tools.base64.decode(e.replace(/(?:\r\n|\r|\n)/g,"")).toString()).replace(/\%SITE\_URL\%/g,mpl_site_url).replace(/\%SITE\_URI\%/g,mpl_site_url),a=JSON.parse(e)}catch(e){a=[{tag:"div",children:[{tag:"text",content:"There was an error with content structure."}]}]}return t(a)},wp_widget:function(e){var t;try{t=JSON.parse(mpl.tools.base64.decode(e))}catch(e){return"There was an error with content structure."}var a,s,i="";for(var l in t){i+='<strong class="prime">'+l.replace(/\-/g," ").replace(/\_/g," ")+"</strong>: ",s=[];for(var r in t[l])""!==t[l][r]&&((a=mpl.tools.esc(t[l][r])).length>250&&(a=a.substr(0,247)+"..."),s[s.length]="<strong>"+r+"</strong>: "+a);i+=s.join(", ")}return i},icon_picker:function(e,t,a){return'<i class="'+e+'" style="font-size: 14px;margin: 0px;font-weight: bold;"></i>'},color_picker:function(e,t){return"<strong>"+t+"</strong>: "+e+' <span style="background: '+e+'"></span>'}},admin_view:{image:function(t,a){var s=mpl_ajax_url+"?action=mpl_get_thumbn&id=undefined",i=void 0!==t.image?t.image:"",l=e("#_thumbnail_id").val();if(void 0!==t.image_source)switch(t.image_source){case"media_library":s=mpl_ajax_url+"?action=mpl_get_thumbn&id="+i;break;case"featured_image":s=mpl_ajax_url+"?action=mpl_get_thumbn&id="+l;break;case"external_link":s=t.image_external_link}return setTimeout(function(t){t.find(".admin-view.custom-admin-view img").attr({title:"Click to select media from library"}).css({cursor:"pointer"}).on("click",{callback:function(t){var a=t.url;"object"==typeof t.sizes.medium&&(a=t.sizes.medium.url),this.el.src=a;var s=mpl.get.model(this.el);void 0!==mpl.storage[s]&&(mpl.storage[s].args.image=t.id,mpl.storage[s].args.image_source="media_library",e(this.el).parent().find(".mpl-param").val(t.id),mpl.confirm(!0))},atts:{frame:"select"}},mpl.tools.media.open)},10,a),'<input type="hidden" class="mpl-param" value="'+i+'" /><img src="'+s+'" />'},gmaps:function(e,t){var a="",s="";return void 0!==e.title&&""!==e.title&&(s+="<strong>Title</strong>: "+e.title+" "),void 0!==e.map_location&&""!==e.map_location&&(a=mpl.tools.base64.decode(e.map_location)),""!==a&&null!==(a=a.match(/src\=\"([^\s]*)\"\s/))&&void 0!==a[1]&&null!==(a=(a=a[1].split("!"))[a.length-6].substr(2)).match(/[^0-9,.]/)&&(s+="<strong>Location</strong>: "+mpl.tools.base64.decode(a)),s},text:function(e,t){return setTimeout(function(e){e.find(".admin-view.custom-admin-view").attr({contentEditable:!0}).data({name:"content"}).on("keyup",mpl.params.admin_label.update),void 0===window.chrome&&e.find(".admin-view.custom-admin-view").on("mousedown",function(e){for(var t=this;t.parentNode;)!0===(t=t.parentNode).draggable&&(t.draggable=!1,t.templDraggable=!0)}).on("blur",function(e){for(var t=this;t.parentNode;)!0===(t=t.parentNode).templDraggable&&(t.draggable=!0,t.templDraggable=null)})},10,t),void 0!==window.switchEditors?switchEditors.wpautop(e.content):e.content}}}),e().extend(mpl.params,{process:function(){"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();var t=e("#content").val();void 0!==t&&""!==t.trim()&&((t=t.replace(/\[vc\_/g,"[mpl_").replace(/\[\/vc\_/g,"[/mpl_").replace(/\[mini\_/g,"[mpl_").replace(/\[\/mini\_/g,"[/mpl_").replace(/\[mpl\_section\_service\_2/g,"[mpl_section_service").replace(/\[mpl\_section\_service\_3/g,"[mpl_section_service").replace(/\[mpl\_section\_service\_4/g,"[mpl_section_service").replace(/\[mpl\_section\_service\_5/g,"[mpl_section_service").replace(/\[mpl\_section\_post\_carousel\_2/g,"[mpl_section_post_carousel").replace(/\[mpl\_section\_carousel\_post/g,"[mpl_section_post_carousel").toString().trim()).indexOf("[mpl_row")>0&&(t=t.substring(t.indexOf("[mpl_row")),(t=mpl.tools.reverse(t)).indexOf("]wor_ck/[")>0&&(t=t.substring(t.indexOf("]wor_ck/["))),t=mpl.tools.reverse(t)),this.process_rows(t))},process_rows:function(e){0!==e.indexOf("[mpl_row")&&(e="[mpl_row"+this.get_atts("mpl_row")+"]"+e.replace(/mpl_row/g,"mpl_row#")+"[/mpl_row]"),this.process_shortcodes(e,function(e){mpl.views.row.render(e)},"mpl_row")},process_columns:function(e,t){this.process_shortcodes(e,function(e){t.append(mpl.views.column.render(e))},"mpl_column")},process_all:function(e,t,a){if(""===e)return!1;if(void 0===t)return!1;var s,i,l=!1,r=!0;mpl_plugin_url;if(mpl.params.process_shortcodes(e,function(e){l=!0,e.parent_wrp=t,e.first=r,r=!1,void 0===mpl.maps[e.name]&&(e.name="mpl_undefined",e.end="[/mpl_undefined]",e.args.content=e.full),_.isUndefined(a)?(i=e.name,void 0!==mpl.maps[e.name].views&&(void 0!==mpl.maps[e.name].views.type&&(i=mpl.maps[e.name].views.type),void 0!==mpl.maps[e.name].views.default&&""===e.args.content&&(e.args.content=mpl.maps[e.name].views.default))):i=a;var n;n="object"==typeof mpl.views[i]?mpl.views[i].render(e):mpl.views.mpl_element.render(e),s=n.data("model"),t.append(n),"views_section"==i&&(setTimeout(function(e,t){mpl.params.process_all(e,t)},1,e.args.content,n.find("> .mpl-views-section-wrap")),mpl.views.views_section.init(e,n))},mpl.tags),!1===l){var n=mpl.views.mpl_undefined.render({args:{content:e},name:"mpl_undefined",end:"[/mpl_undefined]",full:e});s=n.data("model"),t.append(n)}else"views_section"===a&&setTimeout(function(e){mpl.ui.views_sections(e)},1,t);return s},process_alter:function(e,t){void 0===e&&(e="");var a=e.indexOf("["+t+"#");if(a>-1){var s=e.substring(a+1,e.indexOf("]",a)).split(" ")[0],i=new RegExp(s,"g");e=e.replace(i,t)}return e},process_shortcodes:function(e,t,a){if(_.isUndefined(e))return null;for(var s,i,l=new RegExp("\\[(\\[?)("+a+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)","g"),r=e,n=/([a-zA-Z0-9\-\_\.]+)="([^"]+)+"/gi;s=l.exec(e);){for(var o=[];i=n.exec(s[3]);)if("css_custom"===i[1]){var p=e.indexOf("{"),c=e.lastIndexOf("}");o[i[1]]=e.substring(p,c+1).replace(/"/g,"`")}else o[i[1]]=i[2];o._id||(o._id=Math.round(1e6*Math.random()));var m={full:s[0],name:s[2],end:s[6],args:o};_.isUndefined(s[5])||(m.args.content=mpl.params.process_alter(s[5],s[2])),t(m),r=r.replace(s[0],"")}""!==r&&t({full:r,name:"mpl_column_text",end:"[/mpl_column_text]",args:{content:r}})},merge:function(e){if(void 0===e||""==e)return[];var t=[],a=[];if("object"==typeof e?t=e:void 0!==mpl.maps[e]&&(t=mpl.maps[e].params),void 0!==t[0])return t;var s,i;for(s in t)if(void 0!==t[s][0]){i=0;for(i in t[s])a.push(t[s][i])}return a},get_types:function(e){var t=this.merge(e),a={};for(var s in t)void 0!==t[s].name&&(a[t[s].name]=t[s].type);return a},get_values:function(e){var t=this.merge(e),a={};for(var s in t)void 0!==t[s].name&&void 0!==t[s].value&&(a[t[s].name]=t[s].value);return a},get_atts:function(e){var t="",a=this.get_values("mpl_row");for(var e in a)t+=" "+e+'="'+mpl.tools.esc_attr(a[e])+'"';return t}})}(jQuery);