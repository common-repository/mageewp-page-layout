!function(e){window.mpl=e.extend({backbone:{views:function(t){this.ismodel=t,this.el=null,this.events=null,this.render=function(t,a,l,i,o,n){var s=this._render(t,a,l,i,o,n);if(null===this.el&&(this.el=s),"object"==typeof this.events&&mpl.trigger(this),"no-model"!=this.ismodel)if(mpl.front)"mpl_row"!==(t=e().extend(e().extend({args:{},model:r},t))).name&&"mpl_column"!==t.name?(mpl.front.id=null,mpl.front.id=mpl.front.model++,mpl.section_name=t.name,mpl.storage[mpl.front.id]=[],mpl.storage[mpl.front.id].push(t),t.section_num=mpl.front.id):mpl.storage[mpl.front.id].push(t);else{var r=mpl.model++;s.attr({id:"model-"+r}).addClass("mpl-model").data({model:r}),t=e().extend(e().extend({args:{},model:r},t)),mpl.storage[r]=t}return s},this.extend=function(e){for(var t in e)"render"==t?this._render=e.render:this[t]=e[t];return this}},save:function(t){var a=t.data("model");if(void 0!==a)if(mpl.front){if(mpl.front.save_value=!0,mpl.storage[a][0]){var l=mpl.tools.getFormData(t,!0),i={},o=[],n=new RegExp(mpl_site_url,"g");map_values=mpl.params.get_values(mpl.storage[a][0].name),t.find("form.fields-edit-form .mpl-param-row").each(function(){e(this).hasClass("relation-hidden")&&e(this).find(".mpl-param").each(function(){o.push(this.name)})});for(var s in l)if(void 0!==s&&""!==s)if(o.indexOf(s)>-1&&(l[s]=""),""!==l[s]?("object"==typeof l[s]&&("string"==typeof l[s][0]&&""===l[s][0]&&delete l[s][0],l[s]=mpl.tools.base64.encode(JSON.stringify(l[s]).toString().replace(n,"%SITE_URL%"))),i[s]=l[s]):-1==o.indexOf(s)&&void 0!==map_values[s]&&""!==map_values[s]&&void 0===i[s]&&(i[s]="__empty__"),""===l[s]&&void 0===i[s]){if(void 0===mpl.storage[a][0].args[s])continue;delete mpl.storage[a][0].args[s]}else mpl.storage[a][0].args[s]=i[s],"content"==s&&!0===mpl.maps[mpl.storage[a][0].name].is_container?mpl.storage[a][0].end="[/"+mpl.storage[a][0].name+"]":"mpl_section_html"!==mpl.storage[a][0].name&&(mpl.storage[a][0].args[s]=mpl.tools.esc_attr(mpl.storage[a][0].args[s]));delete map_values,mpl.confirm(!0)}}else if(mpl.storage[a]){var l=mpl.tools.getFormData(t,!0),i={},o=[],n=new RegExp(mpl_site_url,"g");map_values=mpl.params.get_values(mpl.storage[a].name),t.find("form.fields-edit-form .mpl-param-row").each(function(){e(this).hasClass("relation-hidden")&&e(this).find(".mpl-param").each(function(){o.push(this.name)})});for(var s in l)if(void 0!==s&&""!==s)if(o.indexOf(s)>-1&&(l[s]=""),""!==l[s]?("object"==typeof l[s]&&("string"==typeof l[s][0]&&""===l[s][0]&&delete l[s][0],l[s]=mpl.tools.base64.encode(JSON.stringify(l[s]).toString().replace(n,"%SITE_URL%"))),i[s]=l[s]):-1==o.indexOf(s)&&void 0!==map_values[s]&&""!==map_values[s]&&void 0===i[s]&&(i[s]="__empty__"),""===l[s]&&void 0===i[s]){if(void 0===mpl.storage[a].args[s])continue;delete mpl.storage[a].args[s]}else mpl.storage[a].args[s]=i[s],"content"==s&&!0===mpl.maps[mpl.storage[a].name].is_container?mpl.storage[a].end="[/"+mpl.storage[a].name+"]":mpl.storage[a].args[s]=mpl.tools.esc_attr(mpl.storage[a].args[s]);delete map_values,mpl.confirm(!0)}},settings:function(t,a){if(void 0!==t){var l=void 0!==t.tagName?t:this,i={},o={},n={};if(mpl.front?(i=mpl.front.get.front_model(l),o=mpl.storage[i][0],n=mpl.tools.popup):(i=mpl.get.model(l),o=mpl.storage[i],n=mpl.tools.popup),void 0===mpl.maps[o.name])return!1;var s=e().extend({},mpl.maps._std);void 0===(s=e().extend(s,mpl.maps[o.name])).title&&(s.title=s.name+" Settings");var r={title:s.title,width:s.pop_width,height:400,scrollBack:!1,scrollTo:!1,storage:o.args,params:s,class:o.name+"_wrpop mpl-elm-settings-popup"};void 0!==a&&(r=e.extend(r,a));var p=n.render(l,r);mpl.ui.fix_position_popup(p),p.data({model:i,callback:mpl.backbone.save}),mpl.front&&p.data({el:e('section[data-front-model="'+i+'"]')});var d=e('<form class="fields-edit-form mpl-pop-tab form-active"></form>');if(void 0!==s.params[0])mpl.params.fields.render(d,s.params,o.args);else{for(var c in s.params)n.add_tab(p,{title:c,class:"mpl-tab-general-"+mpl.tools.esc_slug(c),cfg:c+"|"+i+"|"+o.name,callback:mpl.params.fields.tabs});p.find(".m-p-wrap>.mpl-pop-tabs>li").first().trigger("click")}return p.find(".m-p-body").append(d),delete groups,p}},double:function(t,a){if(void 0===t)return!1;var l,i,o=void 0!==t.tagName?t:this,n=mpl.get.model(o),s=mpl.storage[n],r=e().extend(!0,{},s),p=["mpl_column","mpl_column_inner"].indexOf(s.name)>-1;if(r.args._id=Math.round(1e6*Math.random()),void 0===a)var a=mpl.backbone.export(n);if("mpl_column_text"!=s.name&&(r.args.content=mpl.params.process_alter(a.content,s.name)),o=e("#model-"+n),!(p&&o.parent().find(">.mpl-model").length>=10)){if(r.model=mpl.model++,"mpl_row"==s.name)l=mpl.views.row.render(r,!0);else if("mpl_column"==s.name)l=mpl.views.column.render(r,!0);else if(mpl.tags.indexOf(r.name)){try{i=mpl.maps[r.name].views.type}catch(e){i=r.name}l="object"==typeof mpl.views[i]?mpl.views[i].render(r):mpl.views.mpl_element.render(r)}else l=mpl.views.mpl_undefined.render({args:{content:r.content},name:"mpl_undefined",end:"[/mpl_undefined]",full:r.content});return o.after(l),p&&mpl.views.column.reset_view(o.parent()),o.height()>300&&!o.hasClass("mpl-column")&&e("html,body").scrollTop(e(window).scrollTop()+o.height()),mpl.ui.sortInit(),l}alert(mpl.__.i54)},add:function(t){t.preventDefault();var a=void 0!==t.tagName?t:this,l={title:mpl.__.i02,width:1300,class:"no-footer mpl-adding-elements",float:!0};e(window).width()<1350&&(l.class+=" mpl-small-screen-pop",l.width=950);var i=mpl.tools.popup.render(a,l),o="bottom",n=mpl.get.model(a);e(a).closest(".pos-top").length>0&&(o="top"),i.data({model:n,pos:o}),i.find("h3.m-p-header").append(e('<input type="search" class="mpl-components-search" placeholder="'+mpl.__.i03+'" />').on("keyup",mpl.ui.search_elements)).append('<i class="sl-magnifier"></i>');var s=e(mpl.template("components",{model:n,pos:o}));return i.find(".m-p-body").append(s),mpl.trigger({el:s,events:{"ul.mpl-components-categories li[data-category]:click":"categories","ul.mpl-components-list-main li:click":"items"},categories:function(t){var a,l=e(this).data("category"),i={};return mpl.cfg.elmTabActive=l,mpl.backbone.stack.set("MPL_Configs",mpl.cfg),e(this).parent().find(".active").removeClass("active"),e(this).addClass("active"),t.data.el.find("#mpl-clipboard,.mpl-wp-widgets-pop").remove(),e(this).hasClass("mcl-clipboard")?(t.data.el.find(".mpl-components-list-main").css({display:"none"}),a=e(mpl.template("clipboard",i)),t.data.el.append(a),void("function"==typeof i.callback&&i.callback(a))):e(this).hasClass("mcl-wp-widgets")?(t.data.el.find(".mpl-components-list-main").css({display:"none"}),a=e(mpl.template("wp-widgets-element",i)),t.data.el.append(a),void("function"==typeof i.callback&&i.callback(a,t))):(t.data.el.find(".mpl-components-list-main").show(),void("all"==l?t.data.el.find(".mpl-components-list-main li").show():(t.data.el.find(".mpl-components-list-main li, #mpl-clipboard").css({display:"none"}),t.data.el.find(".mpl-components-list-main .mcpn-"+l).show())))},items:function(t){if("pro"==e(this).data("rule")){var a=e(this).find(".cpdes").text();mpl.msg(a+' only available in pro version.<br/><a style="margin-top:20px;" class="button button-primary" href="https://www.mageewp.com/peony-theme.html" target="_blank">Get Peony Pro</a>',"MPL Pro Support","sl-close",3e3)}else{var l=mpl.ui.prepare(e(this).data("name"),e(this).data("data"));mpl.front&&e.ajax({url:mpl_ajax_url,method:"POST",dataType:"html",data:{action:"mpl_front_section_data",shortcode:l},success:function(t){var a=t.match(/<style type="text\/css">(.)*<\/style>/)[0];a=a.replace(/<style type="text\/css">/,"").replace(/<\/style>/,""),t=t.replace(/<style type="text\/css">(.)*<\/style>/,"");var l=mpl._$(t);mpl._$(l).attr("data-front-model",mpl.front.id);var i=mpl._$("#mpl-css-render").html();mpl._$("#mpl-css-render").html(i+a),mpl._$(".mpl-content-wrap").append(l);var o=mpl._$("body").height()-mpl._$(window).height();o>0&&(mpl._$("html").css("overflow",""),mpl._$("body").scrollTop(o)),e("#mpl-live-frame").get(0).contentWindow.mpl_front.refresh('.mpl-content-wrap section[data-front-model="'+mpl.front.id+'"]'),mpl.front.addToolsListener()}}),mpl.backbone.dopush(l,this)}}}),i.find(".mpl-components-search").focus(),void 0!==mpl.cfg.elmTabActive&&i.find('.mpl-components-categories li[data-category="'+mpl.cfg.elmTabActive+'"]').trigger("click"),i},remove:function(t){var a=!0;if(!1===confirm("Are you sure that you want to delete this section?")&&(a=!1),!1===a)return!1;var l=void 0!==t.tagName?t:this,i=e("#mpl-undo-deleted-element"),o=e("#mpl-storage-prepare"),n=e("#model-"+mpl.get.model(l)),s={parent:n.parent().get(0)};n.next().hasClass("mpl-model")&&(s.next=n.next().get(0)),n.prev().hasClass("mpl-model")&&(s.prev=n.prev().get(0));var r=1;o.find(">.mpl-model").each(function(){if(++r>mpl.cfg.limitDeleteRestore){var t=e(this).data("model");delete mpl.storage[t],e("#model-"+t).remove()}}),n.data({relate:s}),o.prepend(n),i.find("span.amount").html(o.find(">.mpl-model").length),i.css({top:0}),void 0===i.find(".do-action").data("event")&&(i.find(".sl-close").off("click").on("click",function(){e("#mpl-undo-deleted-element").css({top:-132})}),i.find(".do-action").off("click").on("click",function(){var t=e("#mpl-storage-prepare>.mpl-model").first();if(!t.get(0))return e(this.parentNode).find(".sl-close").trigger("click"),!1;var a=t.data("relate");if(void 0!==a.next)e(a.next).before(t);else if(void 0!==a.prev)e(a.prev).after(t);else{if(void 0===a.parent){e(this.parentNode).find(".sl-close").trigger("click");var l=e(this).data("model");return delete mpl.storage[l],e("#model-"+l).remove(),!1}e(a.parent).append(t)}e(".show-drag-helper").removeClass("show-drag-helper"),mpl.ui.scrollAssistive(t);var i=e("#mpl-storage-prepare>.mpl-model").length;e(this).find("span.amount").html(i),0===i&&e(this.parentNode).find(".sl-close").trigger("click")}),i.find(".do-action").data({event:"added"})),mpl.confirm(!0)},copy:function(t){var a,l=void 0!==t.tagName?t:this,i=mpl.get.model(l),o=mpl.backbone.export(i),n="",s=0,r=mpl.backbone.stack,p=r.get("MPL_ClipBoard");if(e("#model-"+i+" .admin-view").each(function(){++s<2&&(0===e(this).find("img").length?(a=mpl.tools.esc(e(this).text())).length>38&&(a=a.substring(0,35)+"..."):e(this).hasClass("gmaps")?(a=e(this).find(".gm-style img"),a='<img src="'+a.eq(parseInt(a.length/2,10)).attr("src")+'" />'):a='<img src="'+e(this).find("img").first().attr("src")+'" />',n+="<i>"+a+"</i>")}),p.length>mpl.cfg.limitClipboard-2){p=p.reverse();for(var d=[],c=0;c<mpl.cfg.limitClipboard-2;c++)d[c]=p[c];r.set("MPL_ClipBoard",d.reverse())}var m=e("#title").val()?mpl.tools.esc(e("#title").val().trim()):"Mageewp Page Builder",u=o.begin+o.content+o.end;r.clipboard.add({page:m,content:mpl.tools.base64.encode(u),title:mpl.storage[i].name,des:n}),mpl.backbone.stack.set("MPL_RowClipboard",u),mpl.tools.toClipboard(u)},cut:function(t){var a=void 0!==t.tagName?t:this;mpl.backbone.copy(a),e(a).parent().find(".delete").trigger("click"),mpl.msg(mpl.__.i60)},more:function(t){var a=void 0!==t.tagName?t:this;e(a).hasClass("active")?e(a).removeClass("active"):e(a).addClass("active")},dopush:function(t,a){var l=mpl.get.model(a),i=mpl.backbone.push(t,l,e(a).closest(".mpl-params-popup").data("pos"));null!==i&&(e(a).closest(".mpl-params-popup").data({scrolltop:null}),e("#model-"+i+">.mpl-element-control>.mpl-controls>.edit").trigger("click"),mpl.confirm(!0)),e(a).closest(".mpl-params-popup").find(".m-p-header .sl-close.sl-func").trigger("click")},push:function(t,a,l){if(void 0!==mpl.front&&void 0!==mpl.front.push&&"function"==typeof mpl.front.push)return mpl.front.push(t,a,l);if(mpl.confirm(!0),void 0!==a&&null!==a&&null!==document.getElementById("model-"+a)){var i=e("#model-"+a+" .mpl-column-wrap").length>0?e("#model-"+a+" .mpl-column-wrap").first():e("#model-"+a).parent(),o=mpl.params.process_all(t,i);return 0===e("#model-"+a+" .mpl-column-wrap").length?e("#model-"+a).after(e("#model-"+o)):"top"==l&&e("#model-"+o).parent().prepend(e("#model-"+o)),mpl.ui.sortInit(),mpl.ui.scrollAssistive(e("#model-"+o)),o}mpl.params.process_shortcodes(t,function(e){mpl.views.row.render(e)},"mpl_row");var n=e("#mpl-rows .mpl-row").last();return mpl.ui.scrollAssistive(n),n.addClass("mpl-bounceIn"),setTimeout(function(e){e.removeClass("mpl-bounceIn")},1200,n),mpl.ui.sortInit(),n.data("model")},extend:function(e,t,a){if(void 0===a&&(a=[]),"object"!=typeof t)return t;for(var l in t)(a.indexOf(l)>-1||0===a.length)&&(void 0!==t[l].selector?e[l]=t[l]:e[l]=mpl.backbone.extend({},t[l]));return e},export:function(t,a){var l=mpl.storage[t];if(_.isUndefined(l))return null;if(_.isUndefined(l.name))return l.full;if(_.isUndefined(a)&&(a=[]),void 0!==mpl.maps[i])return l.full;var i=l.name;if("mpl_undefined"==i)return{begin:"",content:mpl.storage[t].args.content,end:""};if(void 0!==mpl.maps[i]&&!0===mpl.maps[i].is_container)for(;a.indexOf(l.name)>-1;)l.name+="#",l.end="[/"+l.name+"]";var o=e("#model-"+t),n=mpl.params.get_types(i),s="["+l.name,r="",p="";for(var d in l.args)"content"==d&&void 0===n[d]||(void 0!==n[d]&&"textarea_html"==n[d]?(l.args.content=switchEditors.wpautop(l.args.content),r=l.args.content):s+=" "+d+'="'+l.args[d]+'"');if(s+="]",void 0!==mpl.maps[i]&&!0===mpl.maps[i].is_container){a[a.length]=l.name;var c=o.find(".mpl-model").first().parent().find("> .mpl-model");c.length>0&&(r="",c.each(function(){var t=e(this).data("model");if(!_.isUndefined(t)){var l=mpl.backbone.export(t,e().extend([],a));r+=l.begin+l.content+l.end}}),mpl.storage[t].args.content=r),p="[/"+l.name+"]",mpl.storage[t].content=r,mpl.storage[t].end="[/"+i+"]"}return mpl.storage[t].name=i,{begin:s,content:r,end:p}}}},window.mpl),window.mpl.backbone=e.extend({stack:{clipboard:{sort:function(){var t=[];e("#mpl-clipboard>.ms-list>li").each(function(){t[t.length]=e(this).data("sid")}),mpl.backbone.stack.sort("MPL_ClipBoard",t)},add:function(e){var t=mpl.backbone.stack.get("MPL_ClipBoard"),a=[],l=-1;if("object"==typeof t&&t.length>mpl.cfg.limitClipboard){for(var i in t)l++,t.length-l<mpl.cfg.limitClipboard&&(a[a.length]=t[i]);mpl.backbone.stack.set("MPL_ClipBoard",a)}mpl.backbone.stack.add("MPL_ClipBoard",e)}},sections:{},add:function(e,t){if("undefined"!=typeof Storage){var a=this.get(e);""===a?a=[]:"object"!=typeof a&&(a=[a]),a[a.length]=t,this.set(e,a)}else alert(mpl.__.i04)},update:function(e,t,a){if("undefined"!=typeof Storage){var l=this.get(e);if(""===l)l={};else if("object"!=typeof l){var i={};i[e]=l,l=i}l[t]=a,this.set(e,l)}else alert(mpl.__.i04)},get:function(e,t){if("undefined"!=typeof Storage){var a,l=localStorage[e];if(void 0===l)return"";if(void 0===(l=l.toString().trim())||""===l||0!==l.indexOf("[")&&0!==l.indexOf("{"))return l;try{a=JSON.parse(l)}catch(e){a=l}return void 0===t?a:void 0!==a[t]?a[t]:""}return alert(mpl.__.i04),""},set:function(e,t){"object"==typeof t&&(t=JSON.stringify(t)),localStorage.removeItem(e),localStorage.setItem(e,t)},sort:function(e,t){var a=this.get(e),l=[];for(var i in t)void 0!==a[t[i]]&&(l[l.length]=a[t[i]]);this.set(e,l)},remove:function(e,t){var a=this.get(e);delete a[t],this.set(e,a)},reset:function(e){var t=this.get(e),a=[];if(""===t)this.clear(e);else for(var l in t)null!==t[l]&&(a[a.length]=t[l]);this.set(e,a)},clear:function(e){if("undefined"==typeof Storage)return alert(mpl.__.i04),{};localStorage.removeItem(e)}}},window.mpl.backbone),window.mpl=e.extend({ui:{elm_start:null,elm_drag:null,elm_over:null,over_delay:!1,over_timer:null,key_down:!1,elm_prev:null,elm_next:null,init:function(){mpl.body=document.querySelectorAll("body")[0],mpl.html=document.querySelectorAll("html")[0],e(document).on("mousedown",function(e){mpl.ui.elm_start=e.target}),e(window).on("scroll",document.getElementById("major-publishing-actions"),mpl.ui.publishAction),e(window).on("keydown",this.keys_press)},keys_press:function(t){if(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey){var a=!1;if(83===t.keyCode)return mpl.do_action("mpl-ctrl-s",t),t.preventDefault(),t.stopPropagation(),!1;if("INPUT"==t.target.tagName||"TEXTAREA"==t.target.tagName)return!0;if(90===t.keyCode){if(null!==mpl.id("mpl-instantor"))return!0;t.shiftKey?mpl.do_action("mpl-shift-ctrl-z",t):mpl.do_action("mpl-ctrl-z",t),a=!0}else 69===t.keyCode&&(mpl.do_action("mpl-ctrl-e",t),a=!0);if(a)return t.preventDefault(),t.stopPropagation(),!1}else if(13===t.keyCode){mpl.do_action("mpl-enter");var l=e(".mpl-params-popup").not(".no-footer").find(">.m-p-wrap>.m-p-header>.sl-check.sl-func").last(),i=!0,o=t.target;if("INPUT"==o.tagName){var n=e(o).closest(".mpl-params-popup").not(".no-footer").find(">.m-p-wrap>.m-p-header>.sl-check.sl-func");n.length>0&&(l=n,e(o).trigger("change"))}for(;void 0!==o&&o.parentNode;){if(el_type=void 0!==o.tagName?o.tagName:"","TEXTAREA"==el_type||"true"==e(o).attr("contenteditable")){i=!1;break}o=o.parentNode}if(l.length>0&&!0===i)return l.trigger("click"),t.preventDefault(),t.stopPropagation(),!1}else if(27===t.keyCode)return e(".mpl-params-popup").find(">.m-p-wrap>.m-p-header>.sl-close.sl-func").last().trigger("click"),mpl.do_action("mpl-esc"),t.preventDefault(),t.stopPropagation(),!1;return!0},views_sections:function(t){t.find(">.mpl-views-sections-label .section-label").off("click").on("click",t,function(t){e(this).closest(".mpl-views-sections-wrap").find(">.mpl-views-section.mpl-model").removeClass("mpl-section-active"),e("#model-"+e(this).data("pmodel")).addClass("mpl-section-active"),t.data.find(">.mpl-views-sections-label .section-label").removeClass("sl-active"),e(this).addClass("sl-active")}),t.find(">.mpl-views-section > .mpl-vertical-label").off("click").on("click",t,function(t){var a=!1;if(e(this).parent().hasClass("mpl-section-active")&&(a=!0),e(this).closest(".mpl-views-sections-wrap").find(">.mpl-views-section.mpl-model").removeClass("mpl-section-active"),!0!==a){e(this).parent().addClass("mpl-section-active");var l=mpl.tools.popup.coordinates(this,100);e(window).scrollTop()-l[0]>100&&e("html,body").scrollTop(l[0]-200)}}),t.closest(".mpl-views-sections").hasClass("mpl-views-vertical")?mpl.ui.sortable({items:"div.mpl-views-vertical > div.mpl-views-sections-wrap > div.mpl-views-section",handle:">h3.mpl-vertical-label",connecting:!1,vertical:!0,helper:["mpl-ui-handle-image",25,25],start:function(t,a){e(a).parent().addClass("mpl-sorting")},end:function(t,a){e(a).parent().removeClass("mpl-sorting")}}):mpl.ui.sortable({items:"div.mpl-views-sections-label>div.section-label",vertical:!1,end:function(t,a){e(a).closest(".mpl-views-sections-label").find(">.section-label").each(function(){var t=e(this).data("pmodel"),a=e("#model-"+t);a.parent().append(a)})}})},clipboard:function(t){mpl.ui.sortable({items:"#mpl-clipboard > ul.ms-list > li",connecting:!1,vertical:!1,placeholder:"mpl-ui-cb-placeholder",end:function(){mpl.backbone.stack.clipboard.sort()}}),t.find(">ul.ms-list>li").on("click",function(t){if(e(t.target).hasClass("ms-quick-paste")){e(this).addClass("active");var a,l=mpl.backbone.stack.get("MPL_ClipBoard"),i=mpl.get.model(this),o="";return list=e(this).closest("#mpl-clipboard").find("ul.ms-list>li.active").each(function(){a=e(this).data("sid"),"object"==typeof l[a]&&(o+=mpl.tools.base64.decode(l[a].content))}),""===(o=o.trim())?(alert(mpl.__.i06),!1):(void 0!==i?mpl.backbone.push(o,i,e(this).closest(".mpl-params-popup").data("pos")):mpl.backbone.push(o),void mpl.tools.popup.close_all())}e(this).hasClass("active")?e(this).removeClass("active"):e(this).addClass("active")}),mpl.trigger({el:t.find(">ul.ms-funcs"),list:t.find("ul.ms-list>li"),events:{">li.select:click":"select",">li.unselect:click":"unselect",">li.delete:click":"delete",">li.latest:click":"latest",">li.paste:click":"paste",">li.pasteall:click":"pasteall"},select:function(e){e.data.list.addClass("active")},unselect:function(e){e.data.list.removeClass("active")},delete:function(t){t.data.list.each(function(){e(this).hasClass("active")&&(mpl.backbone.stack.remove("MPL_ClipBoard",e(this).data("sid")),e(this).remove())}),mpl.backbone.stack.reset("MPL_ClipBoard")},latest:function(t){var a=mpl.backbone.stack.get("MPL_ClipBoard"),l=a[a.length-1],i=mpl.tools.base64.decode(l.content),o=mpl.get.model(this);o?mpl.backbone.push(i,o,e(this).closest(".mpl-params-popup").data("pos")):mpl.backbone.push(i),e(".mpl-params-popup").remove()},pasteall:function(t){var a=mpl.backbone.stack.get("MPL_ClipBoard"),l=mpl.get.model(this),i="";for(var o in a)"object"==typeof a[o]&&(i+=mpl.tools.base64.decode(a[o].content));if(""===(i=i.trim()))return alert(mpl.__.i05),!1;l?mpl.backbone.push(i,l,e(this).closest(".mpl-params-popup").data("pos")):mpl.backbone.push(i),e(".mpl-params-popup").remove()},paste:function(t){var a,l=mpl.backbone.stack.get("MPL_ClipBoard"),i=mpl.get.model(this),o="";if(list=e(this).closest("#mpl-clipboard").find("ul.ms-list>li.active").each(function(){a=e(this).data("sid"),"object"==typeof l[a]&&(o+=mpl.tools.base64.decode(l[a].content))}),""===(o=o.trim()))return alert(mpl.__.i06),!1;i?mpl.backbone.push(o,i,e(this).closest(".mpl-params-popup").data("pos")):mpl.backbone.push(o),e(".mpl-params-popup").remove()}})},scrollAssistive:function(t,a){if(1!=mpl.cfg.scrollAssistive)return!1;"object"==typeof t&&e(t).get(0)&&(t=e(t).get(0).getBoundingClientRect().top+e(window).scrollTop()-100),void 0!==a&&!1===a?e("html,body").scrollTop(t):e("html,body").stop().animate({scrollTop:t})},preventScroll:function(t){1==mpl.cfg.preventScrollPopup&&!0===e.browser.chrome&&(t.addClass("mpl-prevent-scroll"),t.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(t){if(this.scrollHeight>this.offsetHeight){if(e("body").hasClass("mpl-ui-dragging"))return!0;var a=this.scrollTop;void 0===this.scrollCalc&&(this.scrollCalc=0);var l=t.originalEvent,i=l.wheelDelta||-l.detail;if(0!==i&&(this.scrollTop-=i,a==this.scrollTop)){var o=this.parentNode.parentNode,n=o.offsetTop-80,s=o.offsetTop+(o.offsetHeight-window.innerHeight)+100;i<0?(mpl.body.scrollTop-i<s?mpl.body.scrollTop-=i:mpl.body.scrollTop=s,mpl.html.scrollTop-i<s?mpl.html.scrollTop-=i:mpl.html.scrollTop=s):(mpl.body.scrollTop-i>n?mpl.body.scrollTop-=i:mpl.body.scrollTop=n,mpl.html.scrollTop-i>n?mpl.html.scrollTop-=i:mpl.html.scrollTop=n)}return null!==t.target&&("OPTION"===t.target.tagName||"SELECT"===t.target.tagName||t.target.className.indexOf("mpl-free-scroll")>-1)||(t.preventDefault(),t.stopPropagation(),!1)}}))},scroll:function(e){if("object"!=typeof e)return{top:mpl.body.scrollTop?mpl.body.scrollTop:mpl.html.scrollTop,left:mpl.body.scrollLeft?mpl.body.scrollLeft:mpl.html.scrollLeft};void 0!==e.top&&(mpl.body.scrollTop=e.top,mpl.html.scrollTop=e.top),void 0!==e.left&&(mpl.body.scrollLeft=e.left,mpl.html.scrollLeft=e.left)},mpl_box:{sort:function(){mpl.ui.sortable({items:".mpl-box:not(.mpl-box-column)",connecting:!0,handle:">ul.mb-header",helper:["mpl-ui-handle-image",25,25],detectEdge:30}),void 0===window.chrome&&e(".mpl-box-body .mpl-box-inner-text").off("mousedown").on("mousedown",function(e){for(var t=this;t.parentNode;)!0===(t=t.parentNode).draggable&&(t.draggable=!1,t.templDraggable=!0)}).off("blur").on("blur",function(e){for(var t=this;t.parentNode;)!0===(t=t.parentNode).templDraggable&&(t.draggable=!0,t.templDraggable=null)})},renderBack:function(e){var t=JSON.stringify(mpl.ui.mpl_box.accessNodesVisual(e.find(".mpl-box-render"))).toString(),a=new RegExp(mpl_site_url,"g");t=t.replace(a,"%SITE_URL%"),e.find(".mpl-param.mpl-box-area").val(mpl.tools.base64.encode(t))},wrapFreeText:function(t){var a,l,i,o=t.childNodes;if(void 0===o)return null;for(var n=0;n<o.length;n++)l=o[n],3==o[n].nodeType?"TEXT"!=l.parentNode.tagName&&""!==l.textContent.trim()&&(a=document.createElement("text"),null!==l.nextElementSibling?e(l.nextElementSibling).before(a):null!==l.previousElementSibling?e(l.previousElementSibling).after(a):l.parentNode.appendChild(a),a.appendChild(l)):["input","br","select","textarea","button"].indexOf(o[n].tagName.toLowerCase())>-1?(i=!1,null!==l.previousElementSibling&&"TEXT"==l.previousElementSibling.tagName&&(e(l.previousElementSibling).append(o[n]),i=!0),null!==l.nextElementSibling&&"TEXT"==l.nextElementSibling.tagName&&(e(l.nextElementSibling).prepend(o[n]),i=!0),!1===i&&(a=document.createElement("text"),e(o[n]).after(a),a.appendChild(o[n]))):mpl.ui.mpl_box.wrapFreeText(o[n]);return t},accessNodes:function(e,t){if(null===e)return[];var a,l,i,o=e.childNodes;if(void 0===t&&(t=[]),null===o)return t;for(var n=0;n<o.length;n++)if(1==o[n].nodeType){i={};for(var s=0;s<o[n].attributes.length;s++)i[o[n].attributes[s].name]=o[n].attributes[s].value;"text"!=(a={tag:o[n].tagName.toLowerCase(),attributes:i}).tag&&(a.children=mpl.ui.mpl_box.accessNodes(o[n])),l=void 0!==o[n].className?o[n].className:"","text"==a.tag?a.content=o[n].innerHTML:"img"==a.tag?a.tag="image":l.indexOf("fa-")>-1||l.indexOf("et-")>-1||l.indexOf("sl-")>-1?a.tag="icon":"column"==a.tag&&(""===l&&(l="one-one"),["one-one","one-second","one-third","two-third"].forEach(function(e){l.indexOf(e)>-1&&(l=l.replace(e,"").trim(),a.attributes.cols=e,a.attributes.class=l)})),t[t.length]=a}return t},accessNodesVisual:function(t){var a,l=t.find(">.mpl-box:not(.mb-helper)"),i=[];return 0===l.length?i:(l.each(function(){void 0===(a={tag:e(this).data("tag"),attributes:e(this).data("attributes"),children:mpl.ui.mpl_box.accessNodesVisual(e(this).find(">.mpl-box-body"))}).attributes&&(a.attributes={}),"text"==a.tag?a.content=e(this).find(".mpl-box-inner-text").html():"icon"==a.tag?a.attributes.class=e(this).find(">.mpl-box-body i").attr("class"):"image"==a.tag&&(a.attributes.src=e(this).find(">.mpl-box-body img").attr("src")),i[i.length]=a}),i)},exportCode:function(e,t){var a="";void 0===t&&(t="");var l=t+"\t",i=0;return e.forEach(function(o){if("text"==o.tag)""!==o.content&&(a+=t+"<text>"+o.content.trim().replace(/\<text\>/g,"").replace(/\<\/text\>/g,"")+"</text>");else if("one-one"==o.attributes.cols)o.children.length>0&&(a+=mpl.ui.mpl_box.exportCode(o.children,t));else{void 0!==o.attributes.cols&&(o.attributes.class=void 0!==o.attributes.class?o.attributes.class+" "+o.attributes.cols:o.attributes.cols,delete o.attributes.cols),a+=t+"<"+o.tag;for(var n in o.attributes)a+=" "+n+'="'+mpl.tools.esc(o.attributes[n])+'"';a+=">",o.children.length>0&&(a+="\n"+mpl.ui.mpl_box.exportCode(o.children,l)+"\n"+t),a+="</"+o.tag+">"}i++<e.length-1&&(a+="\n")}),a},setColumns:function(t){var a,l,i=mpl.get.popup(this).data("el").closest(".mpl-box").find(">.mpl-box-body"),o=e(this).data("cols").split(" "),n=i.find(">.mpl-box.mpl-box-column");for(a=0;a<o.length;a++)n.get(a)?n.eq(a).attr({class:"mpl-box mpl-box-column mpl-column-"+o[a]}).data("attributes").cols=o[a]:i.append(mpl.template("box-design",[{tag:"column",attributes:{cols:o[a]}}]));if(a<n.length)for(l=a;l<n.length;l++)n.eq(l).find(">.mpl-box-body>.mpl-box:not(.mb-helper)").each(function(){n.eq(a-1).append(this)}),n.eq(l).remove();mpl.get.popup(this,"close").trigger("click"),mpl.ui.mpl_box.sort()},actions:function(t,a){var l,i,o,n,s,r=t.closest(".mpl-param-row").find(".mpl-box-render");switch(t.data("action")){case"add":e(".mpl-box-subPop").remove(),t.closest(".mb-header").addClass("editting"),l=t.data("pos"),i='<div class="mpl-nodes">',(o=mpl.tools.popup.render(t.get(0),{title:"Select Node Tag",class:"no-footer mpl-nodes mpl-box-subPop",scrollBack:!0,keepCurrentPopups:!0,drag:!1})).data({pos:l,el:t,cancel:function(e){e.data("el").closest(".mb-header").removeClass("editting")}}),["text","image","icon","div","span","a","ul","ol","li","p","h1","h2","h3","h4","h5","h6"].forEach(function(e){i+='<button class="button">'+e+"</button> "}),i=e(i+="</div>"),o.find(".m-p-body").append(i),i.find("button").on("click",function(e){var t=mpl.template("box-design",[{tag:this.innerHTML}]),a=mpl.get.popup(this),l=a.data("pos"),i=a.data("el");return"top"==l?r.prepend(t):"bottom"==l?r.append(t):"inner"==l&&i.closest(".mpl-box:not(.mb-helper)").find(">.mpl-box-body").append(t),mpl.ui.mpl_box.sort(),mpl.get.popup(this,"close").trigger("click"),e.preventDefault(),!1}),a.preventDefault();break;case"columns":e(".mpl-box-subPop").remove(),t.closest(".mb-header").addClass("editting"),i='<div class="mpl-nodes">',(o=mpl.tools.popup.render(t.get(0),{title:"Select Layout - Columns",class:"no-footer mpl-nodes mpl-columns mpl-box-subPop",scrollBack:!0,keepCurrentPopups:!0,drag:!1})).data({el:t,cancel:function(e){e.data("el").closest(".mb-header").removeClass("editting")}}),[["one-one","1/1"],["one-second one-second","1/2 + 1/2"],["one-third two-third","1/3 + 2/3"],["two-third one-third","2/3 + 1/3"],["one-third one-third one-third","1/3 + 1/3 + 1/3"]].forEach(function(e){i+='<button data-cols="'+e[0]+'" class="button '+e[0].replace(" ","")+'"><span>'+e[1]+"</span></button> "}),i=e(i+="</div>"),o.find(".m-p-body").append(i),i.find("button").on("click",mpl.ui.mpl_box.setColumns),a.preventDefault();break;case"remove":if("column"==t.closest(".mpl-box").data("tag")){if(t.closest(".mpl-box").find(">.mpl-box-body>.mpl-box:not(.mb-helper)").length>0&&!confirm(mpl.__.i23))return;n=t.closest(".mpl-box").parent().get(0),t.closest(".mpl-box").remove();var p=e(n).find(">.mpl-box.mpl-box-column"),d="one-one";return 2==p.length&&(d="one-second"),void p.each(function(){e(this).attr({class:"mpl-box mpl-box-column mpl-column-"+d}).data("attributes").cols=d})}var c=t.closest(".mpl-param-row").find(".mpl-box-trash"),m=t.closest(".mpl-box").get(0);(l={}).parent=m.parentNode,m.nextElementSibling&&(l.next=m.nextElementSibling),m.previousElementSibling&&(l.prev=m.previousElementSibling),e(m).data({pos:l}),c.append(m),c.find("a.button").html('<i class="sl-action-undo"></i> '+mpl.__.i24+"("+c.find(">.mpl-box").length+")").removeClass("forceHide");break;case"undo":var u=(c=t.closest(".mpl-param-row").find(".mpl-box-trash")).find(">.mpl-box").last().get(0);if(l=e(u).data("pos"),!u)return;void 0!==l.next?e(l.next).before(u):void 0!==l.prev?e(l.prev).after(u):void 0!==l.parent&&e(l.parent).append(u);var f=c.find(">.mpl-box").length;c.find("a.button").html('<i class="sl-action-undo"></i> '+mpl.__.i24+"("+f+")"),0===f&&c.find("a.button").addClass("forceHide"),a.preventDefault();break;case"double":var g=t.closest(".mpl-box").clone(!0);g.attr({draggable:"",dropable:""}),g.find(".mpl-box").attr({draggable:"",dropable:""}),t.closest(".mpl-box").after(g),mpl.ui.mpl_box.sort();break;case"settings":e(".mpl-box-subPop").remove(),t.closest(".mb-header").addClass("editting"),s=t.closest(".mpl-box").data("attributes"),(o=mpl.tools.popup.render(t.get(0),{title:"Node Settings",class:"mpl-box-settings-popup mpl-box-subPop",scrollBack:!0,keepCurrentPopups:!0,drag:!1})).data({model:null,el:t,cancel:function(e){e.data("el").closest(".mb-header").removeClass("editting")},callback:function(e){e.data("el").closest(".mb-header").removeClass("editting");var t=e.data("el").closest(".mpl-box"),a={};e.find(".fields-edit-form .mpl-param").each(function(){""!==this.value&&(a[this.name]=mpl.tools.esc(this.value))}),void 0!==e.data("css")&&""!==e.data("css")&&(a.style=e.data("css")),void 0!==t.data("attributes").cols&&(a.cols=t.data("attributes").cols),t.data({attributes:a}),["id","class","href"].forEach(function(e){if(void 0!==a[e]){var l=t.find(">.mb-header>.mb-"+e),i=a[e].substr(0,30)+"..";l.length>0?l.find("span").html(i).attr({title:a[e]}):t.find(">.mb-header>.mb-funcs").before('<li class="mb-'+e+'">'+e+': <span title="'+mpl.tools.esc(a[e])+'">'+i+"</span></li>")}})},css:void 0!==s.style?s.style:""}),r=e('<div class="fields-edit-form mpl-pop-tab form-active"></div>');var h=e('<form class="attrs-edit"><input type="submit" class="forceHide" /></form>'),v=function(t,a){var l=e('<div class="mpl-param-row"><div class="m-p-r-label"><label>'+mpl.tools.esc(t)+':</label></div><div class="m-p-r-content"><input name="'+mpl.tools.esc(t)+'" class="mpl-param" value="'+a+'" style="width:90%;" type="text"> &nbsp; <a href="#"><i class="fa-times"></i></a></div></div>');return l.find("a").on("click",function(t){e(this).closest(".mpl-param-row").remove(),t.preventDefault()}),l};h.append(v("id",void 0!==s.id?s.id:"")),h.append(v("class",void 0!==s.class?s.class:"")),"A"==t.closest(".mpl-box").get(0).tagName&&h.append(v("href",void 0!==s.href?s.href:""));for(var b in s)"id"!=b&&"class"!=b&&"style"!=b&&"cols"!=b&&h.append(v(b,s[b]));r.append(h),r.append(function(){var t=e('<div style="padding: 10px 0 10px" class="mpl-param-row align-right"><div class="m-p-r-label"></div><form class="m-p-r-content"><input style="height: 34px;width: 52.5%;" type="text" placeholder="'+mpl.__.i25+'" /> <button style="margin-right: 33px;height: 34px;" class="button button-primary">'+mpl.__.i26+'</button><input type="submit" class="forceHide" /></form></div>');return t.find("button").on("click",function(t){var a=e(this.parentNode).find("input"),l=a.val().replace(/[^a-z-]/g,"");return a.val(""),""===l||e(this).closest(".m-p-body").find("input[name="+l+"]").length>0||"style"==l?(e(this).stop().animate({marginRight:50},100).animate({marginRight:28},100).animate({marginRight:38},80).animate({marginRight:30},80).animate({marginRight:33},50),!1):(e(this).closest(".mpl-param-row").before(v(l,"")),t.preventDefault(),!1)}),t.find("form").on("submit",function(){return e(this).find("button").trigger("click"),!1}),t}()),h.on("submit",function(e){return mpl.get.popup(this,"save").trigger("click"),e.preventDefault(),!1}),o.find(".m-p-body").append(r);break;case"editor":e(".mpl-box-subPop").remove(),t.closest(".mb-header").addClass("editting"),s=t.closest(".mpl-box").data("attributes"),(o=mpl.tools.popup.render(t.get(0),{title:"Node Settings",class:"mpl-box-editor-popup mpl-box-subPop",scrollBack:!0,keepCurrentPopups:!0,drag:!1,width:750})).data({model:null,el:t,cancel:function(e){e.data("el").closest(".mb-header").removeClass("editting")},callback:function(e){var t=e.find("textarea.mpl-param"),a=t.val().toString().trim();e.find(".wp-editor-wrap").hasClass("tmce-active")&&(a=tinyMCE.get(t.attr("id")).getContent()),e.data("el").closest(".mpl-box").find(".mpl-box-inner-text").html(a)}}),s={value:t.closest(".mpl-box").find(".mpl-box-inner-text").html(),options:[],name:"content",type:"textarea_html"},v=mpl.template("field",{label:"",content:mpl.template("field-type-textarea_html",s),des:"",name:"textarea_html",base:"content"}),o.find(".m-p-body").append(v),"function"==typeof s.callback&&setTimeout(s.callback,1,o.find(".m-p-body"),e);break;case"toggle":(r=t.closest(".mpl-box")).hasClass("mpl-box-toggled")?r.removeClass("mpl-box-toggled"):r.addClass("mpl-box-toggled");break;case"html-code":e(".mpl-box-html-code").remove(),s={title:mpl.__.i29,width:700,class:"mpl-box-html-code",keepCurrentPopups:!0,drag:!1},(o=mpl.tools.popup.render(t.get(0),s)).data({target:t,scrolltop:e(window).scrollTop()});var _=mpl.ui.mpl_box.exportCode(mpl.ui.mpl_box.accessNodesVisual(mpl.get.popup(t).find(".mpl-box-render")));o.find(".m-p-body").html("<textarea>"+_+"</textarea>"),o.data({popParent:mpl.get.popup(t),callback:function(t){var a="<div>"+t.find(".m-p-body textarea").val().trim()+"</div>",l=mpl.ui.mpl_box.wrapFreeText(e(a).get(0)),i=mpl.ui.mpl_box.accessNodes(l),o=t.data("popParent");o.find(".mpl-box-render").html(mpl.template("box-design",i)),mpl.ui.mpl_box.sort(),o.find(".mpl-box-trash .mpl-box").remove(),o.find(".mpl-box-trash>a.button").addClass("forceHide")}});break;case"css-code":e(".mpl-box-html-code").remove(),s={title:mpl.__.i30,width:700,class:"mpl-box-html-code",keepCurrentPopups:!0,drag:!1};var w=mpl.get.popup(t);(o=mpl.tools.popup.render(t.get(0),s)).data({target:t,scrolltop:e(window).scrollTop()});var y=w.find(".field-hidden.field-base-css_code input").val();o.find(".m-p-body").html("<p></p><textarea>"+mpl.tools.decode_css(y)+'</textarea><i class="ntips">'+mpl.__.i31+"</i>");var k=e('<button class="button button-larger"><i class="sl-energy"></i> '+mpl.__.i32+"</button>");o.find(".m-p-body").prepend(k),k.on("click",function(){var t=e(this).parent().find("textarea");t.val(mpl.tools.decode_css(t.val()))}),o.data({popParent:mpl.get.popup(t),callback:function(e){var t=mpl.tools.encode_css(e.find("textarea").val());e.data("popParent").find(".field-hidden.field-base-css_code input").val(t)}});break;case"icon-picker":e(".mpl-icons-picker-popup,.mpl-box-subPop").remove();var x=e('<div class="icons-list noneuser">'+mpl.tools.get_icons()+"</div>");s={title:"Select Icons",width:600,class:"no-footer mpl-icons-picker-popup mpl-box-subPop",keepCurrentPopups:!0},(o=mpl.tools.popup.render(t.get(0),s)).data({target:t,scrolltop:jQuery(window).scrollTop()});var C=e('<input type="search" class="mpl-components-search" placeholder="Search by Name" />');o.find(".m-p-header").append(C),C.after('<i class="sl-magnifier"></i>'),C.data({list:x}),C.on("keyup",x,function(t){clearTimeout(this.timer),this.timer=setTimeout(function(t,a){var l;0===a.find(".seach-results").length?(l=e('<div class="seach-results"></div>'),a.prepend(l)):l=a.find(".seach-results");var i=['<span class="label">'+mpl.__.i33+"</span>"];a.find(">i").each(function(){this.className.indexOf(t.value.trim())>-1&&i.length<14&&e.inArray(this.className,i)&&i.push('<span data-icon="'+this.className+'"><i class="'+this.className+'"></i>'+this.className+"</span>")}),i.length>1?(l.html(i.join("")),l.find("span").on("click",function(){mpl.get.popup(this).data("target").find("i").attr({class:e(this).data("icon")}),mpl.get.popup(this,"close").trigger("click")})):l.html('<span class="label">'+mpl.__.i34+"</span>")},150,this,t.data)}),x.find("i").on("click",function(){mpl.get.popup(this).data("target").find("i").attr({class:this.className}),mpl.get.popup(this,"close").trigger("click")}),setTimeout(function(e,t){e.append(t)},10,o.find(".m-p-body"),x);break;case"select-image":mpl.tools.media.open({data:{callback:function(e){var a=e.url;void 0!==e.size&&null!==e.size&&void 0!==e.sizes[e.size]?a=e.sizes[e.size].url:"object"==typeof e.sizes.medium&&(a=e.sizes.medium.url),void 0!==a&&""!==a&&t.attr({src:a})},atts:{frame:"post"}}}).$el.addClass("mpl-box-media-modal")}return t.hasClass("mpl-box-toggled")&&t.hasClass("mpl-box")&&t.removeClass("mpl-box-toggled"),a.preventDefault(),!1}},elms:function(t,a){var l=e(a).data("type"),i=e(a).data("cfg"),o="";if("LI"==t.target.tagName&&"radio"==l){var n=e(t.target).parent();n.find(".active").removeClass("active"),n.find('input[type="radio"]').attr({checked:!1}),e(t.target).addClass("active"),o=e(t.target).find('input[type="radio"]').attr({checked:!0}).val()}"select"==l&&(o=a.value),""!==o&&""!==i&&void 0!==i&&(mpl.cfg[i]=o,mpl.backbone.stack.set("MPL_Configs",mpl.cfg))},prepare:function(e,t,a){var l=void 0!==mpl.maps[e]?mpl.maps[e]:{},i=mpl.params.merge(e),o="["+e;o+=' _id="'+Math.round(1e6*Math.random())+'"',void 0===a&&(a="mpl_row"==e?'[mpl_column width="100%"][/mpl_column]':"mpl_row_inner"==e?'[mpl_column_inner width="100%"][/mpl_column_inner]':""),void 0!==mpl.maps[e]&&void 0!==mpl.maps[e].content&&""===a&&(a=mpl.maps[e].content);for(var n in i)if("random"==i[n].type?o+=" "+i[n].name+'="'+parseInt(1e6*Math.random(),10)+'"':_.isUndefined(i[n].value)||("content"==i[n].name&&!0===l.is_container?a=i[n].value:o+=" "+i[n].name+'="'+i[n].value+'"'),"css"==i[n].type){var s={};if(i[n].options&&(s["mpl-css"]={},i[n].options[0]instanceof Object)){i[n].options[0].screens&&(s["mpl-css"][i[n].options[0].screens]={});for(var r in i[n].options[0])if("screens"!==r&&i[n].options[0][r]instanceof Array)for(var p=0;p<i[n].options[0][r].length;p++)for(var d in i[n].options[0][r][p])i[n].options[0][r][p].value&&(s["mpl-css"][i[n].options[0].screens][r.toLocaleLowerCase()]||(s["mpl-css"][i[n].options[0].screens][r.toLocaleLowerCase()]={}),i[n].options[0][r][p].selector?(s["mpl-css"][i[n].options[0].screens][r.toLocaleLowerCase()][i[n].options[0][r][p].property+"|"+i[n].options[0][r][p].selector]={},s["mpl-css"][i[n].options[0].screens][r.toLocaleLowerCase()][i[n].options[0][r][p].property+"|"+i[n].options[0][r][p].selector]=i[n].options[0][r][p].value):(s["mpl-css"][i[n].options[0].screens][r.toLocaleLowerCase()][i[n].options[0][r][p].property+"|"]={},s["mpl-css"][i[n].options[0].screens][r.toLocaleLowerCase()][i[n].options[0][r][p].property+"|"]=i[n].options[0][r][p].value))}o+=" "+i[n].name+'="'+JSON.stringify(s).replace(/\"/g,"`")+'"'}return"mpl_wp_widget"==e&&(o+=' data="'+t+'"'),o+="]",!0===l.is_container&&(o+=a+"[/"+e+"]"),delete i,o},publishAction:function(t){if(t.data){var a=t.data.getBoundingClientRect(),l=e(window).scrollTop();void 0===t.data.sctop&&(t.data.sctop=a.top+l),t.data.sctop<l+35?e(t.data).addClass("float_publish_action"):e(t.data).removeClass("float_publish_action")}},search_elements:function(t){var a=this.value.toLowerCase();void 0===this.pop&&(this.pop=null!==mpl.get.popup(this)?mpl.get.popup(this):e(this).closest("#mpl-elements-list")),void 0===this.items&&(this.items=this.pop.find(".mpl-components .mpl-components-list-main li")),this.pop.find("#mpl-clipboard,.mpl-wp-widgets-pop").hide(),this.pop.find(".mpl-components .mpl-components-list-main").show(),this.pop.find(".mpl-components .mpl-components-categories .active").removeClass("active"),this.items.css({display:"none"}),this.items.each(function(){(e(this).find("strong").html().toLowerCase().indexOf(a)>-1||""===a)&&(this.style.display="block")})},upgrade_notice:function(e){},lightbox:function(t){var a=e("#mpl-preload .mpl-preload-body");return 0===a.length&&(e("#wpwrap").append('<div id="mpl-preload"><div id="mpl-welcome" style="display: block;" class="mpl-preload-body"><a href="#" class="close"><i class="sl-close"></i></a></div></div>'),(a=e("#mpl-preload .mpl-preload-body")).find("a.close").on("click",function(){e(this).closest("#mpl-preload").remove(),e(".mpl-ui-blur").removeClass("mpl-ui-blur")}),e("#mpl-preload").on("click",function(t){"mpl-preload"==t.target.id&&(e(this).remove(),e(".mpl-ui-blur").removeClass("mpl-ui-blur"))})),a.find(">*:not(a.close)").remove(),!0===(t=e.extend({width:"1000",height:"576",padding:"10",iframe:!1,url:"",msg:""},t)).iframe&&(t.msg='<iframe width="'+t.width+'" height="'+t.height+'" src="'+t.url+'" frameborder="0" allowfullscreen></iframe>'),a.css({width:t.width+"px",height:t.height+"px",padding:t.padding+"px"}).append(t.msg),a},fonts_callback:function(t){window.mpl_fonts=t;var a,l;for(var i in t)l=(l=decodeURIComponent(i)).replace(/\ /g,"-").toLowerCase(),null===document.getElementById(l+"-css")&&(a='<link rel="stylesheet" id="'+l+'-css" href="//fonts.googleapis.com/css?family='+(a=i.replace(/ /g,"+")+":"+t[i][1]+encodeURIComponent("&subset=")+t[i][1])+'" type="text/css" media="all" />',e("head").append(a),void 0!==mpl.frame&&mpl.frame.$("head").append(a))},right_click:function(t){e(".mpl-right-click-dialog").remove();var a=e(t.target).hasClass("mpl-model")?e(t.target):e(t.target).closest(".mpl-model");if(a.length>0){var l=e(window).width(),i=e(window).height(),o=a.attr("id").toString().replace("model-",""),n={position:"fixed",zIndex:99999,left:t.clientX+"px",top:t.clientY+"px"};if(void 0===mpl.storage[o])return!1;e(".mpl-params-popup .sl-close.sl-func").trigger("click");var s=mpl.storage[o].name,r={edit:'<li data-act="edit"><i class="fa-edit"></i> Edit</li>',insert:'<li data-act="insert"><i class="fa-columns"></i> New '+s.replace("mpl_","").replace(/\_/g," ")+"</li>",copy:'<li data-act="copy"><i class="fa-copy"></i> Copy <ul class="sub"><li data-act="copystyle"><i class="fa-paint-brush"></i> Copy style only</li></ul></li>',copystyle:'<li data-act="copystyle"><i class="fa-paint-brush"></i> Copy style only</li>',paste:'<li data-act="paste"><i class="fa-paste"></i> Paste <ul class="sub"><li data-act="pastestyle"><i class="fa-paint-brush"></i> Paste style only</li></ul></li>',double:'<li data-act="double"><i class="fa-clone"></i> Double</li>',add:'<li data-act="add"><i class="fa-plus"></i> Add Sections</li>',cut:'<li data-act="cut"><i class="fa-cut"></i> Cut</li>',clear:'<li data-act="clear"><i class="fa-eraser"></i> Clear style</li>',delete:'<li data-act="delete"><i class="fa-trash"></i> Delete</li>'};["mpl_column","mpl_column_inner"].indexOf(s)>-1?(delete r.copy,delete r.cut):mpl_maps_view.indexOf(s)>-1?delete r.copystyle:(delete r.insert,delete r.copystyle);var p="";for(var d in r)p+=r[d];var c='<div id="mpl-elms-breadcrumn" class="mpl-right-click-dialog">\t\t\t\t\t\t\t<ul>\t\t\t\t\t\t\t\t<li class="item active">\t\t\t\t\t\t\t\t\t<span class="pointer">\t\t\t\t\t\t\t\t\t\t<i class="fa-dot-circle-o"></i> \t\t\t\t\t\t\t\t\t\t'+s.replace(/_/g," ")+"\t\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t\t\t<ul>"+p+"</ul>\t\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t</div>";c=e(c),e("#mpl-right-click-helper").show().html("").append(c),c.css(n).on("mouseover",function(e){a.addClass("mpl-hover-me")}).on("mouseout",function(e){a.removeClass("mpl-hover-me")}).on("click",function(t){var l=e(t.target).data("act");if(void 0!==l){switch(l){case"edit":a.find(".edit").first().trigger("click");break;case"add":mpl.backbone.add(a.get(0));break;case"cut":mpl.backbone.cut(a.find("div").get(0));break;case"copy":mpl.backbone.copy(a.find("div").get(0));break;case"copystyle":void 0===mpl.cfg.copied_style&&(mpl.cfg.copied_style={});var i=mpl.storage[o].name,n=mpl.storage[o].args,s=mpl.params.merge(i),r=[],p={};if(void 0===n._id)return console.warn("MPL: Missing id of the element when trying to render css"),"";for(c in s)"css"==s[c].type&&r.push(s[c].name);for(c in n)(r.indexOf(c)>-1||0===c.indexOf("_css_inspector"))&&(p[c]=n[c]);mpl.cfg.copied_style[i]=p,mpl.backbone.stack.set("MPL_Configs",mpl.cfg);break;case"paste":if(content=mpl.backbone.stack.get("MPL_RowClipboard"),void 0===content||""==content)return void alert(mpl.__.i38);if(0===content.trim().indexOf("[mpl_row ")||0===content.trim().indexOf("[mpl_row ")){var d=mpl.backbone.push(content);a.closest(".mpl-row").after(e("#model-"+d)),mpl.ui.scrollAssistive(e("#model-"+d))}else mpl.backbone.push(content,o,"bottom");break;case"pastestyle":if(void 0===mpl.cfg.copied_style)return;var i=mpl.storage[o].name,n=mpl.storage[o].args;if(void 0===mpl.cfg.copied_style[i])return;for(c in mpl.cfg.copied_style[i])mpl.storage[o].args[c]=mpl.cfg.copied_style[i][c];break;case"double":i=mpl.storage[o].name;mpl_maps_view.indexOf(i)>-1?a.find(">.mpl-vs-control .double").trigger("click"):mpl.backbone.double(a.get(0));break;case"insert":i=mpl.storage[o].name;mpl_maps_view.indexOf(i)>-1?mpl.views.views_sections.do_add_section(a.closest(".mpl-views-sections-wrap").get(0)):mpl.views.column.insert(o);break;case"clear":var c,n=mpl.storage[o].args,s=mpl.params.merge(mpl.storage[o].name),r=[];if(void 0===n._id)return console.warn("MPL: Missing id of the element when trying to clear css"),"";for(c in s)"css"==s[c].type&&r.push(s[c].name);for(c in n)(r.indexOf(c)>-1||0===c.indexOf("_css_inspector"))&&delete mpl.storage[o].args[c];break;case"delete":a.find(".delete").first().trigger("click")}mpl.ui.exit_right_click(!0)}}),t.clientX>l/2?c.css({left:t.clientX-c.width()+"px"}):c.addClass("mpl-rc-left"),t.clientY+32+c.height()>i?c.css({top:i-32-c.height()+"px"}):c.addClass("mpl-rc-top")}e("body").css({overflow:"hidden"})},exit_right_click:function(t){"force"!=t&&0!==e(t.target).closest(".mpl-right-click-dialog").length||(e(".mpl-right-click-dialog").remove(),e("#mpl-right-click-helper").hide(),e(".mpl-hover-me").removeClass("mpl-hover-me"),e("body").css({overflow:""}))},verify_tmpl:function(){var t=e().extend(mpl.cfg,mpl.backbone.stack.get("MPL_Configs"));if(localStorage.MPL_TMPL_CACHE="",t.version==mpl_version&&void 0!==localStorage.MPL_TMPL_CACHE&&""!==localStorage.MPL_TMPL_CACHE)return!0;mpl.msg("Initializing","loading"),e.post(mpl_ajax_url,{action:"mpl_tmpl_storage",security:mpl_ajax_nonce},function(a){e("#mpl-preload").remove(),-1!=a&&0!=a&&(mpl.ui.upgrade_notice(parseFloat(t.version)),t.version=mpl_version,mpl.backbone.stack.set("MPL_Configs",t),mpl.backbone.stack.set("MPL_TMPL_CACHE",a),mpl.init())})},get_tmpl_cache:function(e){if(void 0!==localStorage.MPL_TMPL_CACHE&&localStorage.MPL_TMPL_CACHE.indexOf('id="'+e+'"')>-1){var t=localStorage.MPL_TMPL_CACHE.indexOf(">",localStorage.MPL_TMPL_CACHE.indexOf('id="'+e+'"'))+1,a=localStorage.MPL_TMPL_CACHE.indexOf("<\/script>",t),l=localStorage.MPL_TMPL_CACHE.substring(t,a),i={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return _.template(l,null,i)}return"exit"},uncache:function(){return localStorage.removeItem("MPL_TMPL_CACHE"),window.location.href=window.location.href,"Successfull, reloading now..."},fix_position_popup:function(t){t.find(".wp-pointer-arrow").on("mousedown",function(a){if(void 0!==a.which&&1!==a.which)return!1;e("html,body").css({cursor:"col-resize"}).addClass("mpl_dragging noneuser mpl-ui-dragging");e(document).off("mousemove").on("mousemove",{el:t.get(0),width:parseInt(t.width(),10),eleft:parseInt(t.css("left"),10),left:a.clientX},function(e){e.preventDefault();var t=e.data;t.offset=e.clientX-t.left;var a=t.width+t.offset;a>=1e3||(a<=400&&(a=400),t.el.style.width=a+"px",mpl.cfg.live_popup.width=a+"px")}),e(window).off("mouseup").on("mouseup",{frame:e("#mpl-live-frame").get(0),el:t},function(t){e(document).off("mousemove"),e(window).off("mouseup"),setTimeout(function(){e("html,body").css({cursor:""}).removeClass("mpl_dragging noneuser mpl-ui-dragging")},200)})}),void 0===mpl.cfg.live_popup&&(mpl.cfg.live_popup={top:"50px",left:"750px",width:"661px"});var a=e(window).width(),l=parseInt(mpl.cfg.live_popup.left,10),i=parseInt(mpl.cfg.live_popup.width,10);i+l>a?mpl.cfg.live_popup.left=a-i+"px":l<10&&(mpl.cfg.live_popup.left="0px"),t.css(mpl.cfg.live_popup),!0===mpl.cfg.live_popup.sticky&&t.addClass("mpl-popup-stickLeft")},instantor:{mainTmpl:'<span class="instmore">\t\t\t<select class="format">\t\t\t\t<option value="p">Paragraph</option>\t\t\t\t<option value="h1">Heading 1</option>\t\t\t\t<option value="h2">Heading 2</option>\t\t\t\t<option value="h3">Heading 3</option>\t\t\t\t<option value="h4">Heading 4</option>\t\t\t\t<option value="h5">Heading 5</option>\t\t\t\t<option value="h6">Heading 6</option>\t\t\t\t<option value="pre">Preformatted</option>\t\t\t</select>\t\t\t<i class="fa-align-justify" data-format="justifyfull" title="Text align justify"></i> \t\t\t<i class="fa-font" title="Fill color"></i> \t\t\t<i class="fa-underline" data-format="underline" title="Underline"></i> \t\t\t<i class="fa-strikethrough" data-format="strikethrough" title="Strike through"></i> \t\t\t<i class="fa-eraser" data-act="clearformat" title="Clear formatting"></i> \t\t\t<i class="fa-outdent" data-format="outdent" title="Decrease indent"></i> \t\t\t<i class="fa-indent" data-format="indent" title="Increase indent"></i> \t\t\t<i class="sl-cursor-move" data-act="move" title="Move dialog" style="float:right"></i> \t\t</span> \t\t<span class="instmostuse">\t\t\t<i class="fa-bold" title="Bold" data-format="bold"></i> \t\t\t\t<i class="fa-italic" title="Italic" data-format="italic"></i> \t\t\t\t<i class="fa-list-ul" title="Bulleted list" data-format="insertunorderedlist"></i> \t\t\t\t<i class="fa-list-ol" title="Numbered list" data-format="insertorderedlist"></i> \t\t\t\t<i class="fa-quote-left" title="Blockquote" data-format="formatblock:blockquote"></i> \t\t\t\t<i class="fa-link" title="Insert link" data-act="insertlink"></i> \t\t\t\t<i class="fa-align-left" title="Text align left" data-format="justifyleft"></i> \t\t\t\t<i class="fa-align-center" title="Text align center" data-format="justifycenter"></i> \t\t\t\t<i class="fa-align-right" title="Text align right" data-format="justifyright"></i> \t\t\t\t<i class="fa-image" data-act="insertimages" title="Insert images"></i> \t\t\t\t<i class="sl-options" data-act="more" title="More"></i>\t\t</span>',imageTmpl:'<span class="instmostuse"> \t\t\t<i class="fa-pencil" title="Change image" data-act="changeimage"></i> \t\t\t<i class="fa-align-left" title="Text align left" data-format="justifyleft"></i> \t\t\t<i class="fa-align-center" title="Text align center" data-format="justifycenter"></i> \t\t\t<i class="fa-align-right" title="Text align right" data-format="justifyright"></i> \t\t\t<i class="fa-times" title="Remove image" data-act="removeimage"></i> \t\t\t<label>Width:</label> <input style="width:80px" type="number" data-act="imagewidth" /> \t\t</span>',onclick:function(t,a){if("IMG"==t.target.tagName)return a.setAttribute("data-live-editor",""),a.setAttribute("contenteditable",!0),a.focus(),this.clickImage(t,a);if("open"==a.getAttribute("data-live-editor"))return!1;a.setAttribute("data-live-editor","open"),a.setAttribute("contenteditable",!0),a.focus(),null!==mpl.id("mpl-instantor")&&e("#mpl-instantor").remove(),e("body").append('<div id="mpl-instantor">'+this.mainTmpl+"</div>"),this.possition(t,a,!1);var l=e("#mpl-instantor");return mpl.cfg.instmore&&l.addClass("ismore"),l.data({el:a}),l.on("click",function(t){var a=e(t.target).data("act"),l=e(t.target).data("format");switch(a){case"more":e(this).hasClass("ismore")?(mpl.cfg.instmore=!1,e(this).removeClass("ismore")):(mpl.cfg.instmore=!0,e(this).addClass("ismore")),mpl.backbone.stack.set("MPL_Configs",mpl.cfg);break;case"insertlink":var i=prompt("Write the URL here","http://");i&&""!=i&&"http://"!=i&&mpl.ui.instantor.format("createlink",i);break;case"clearformat":mpl.ui.instantor.clearformat();break;case"insertimages":mpl.tools.media.opens({data:function(e){mpl.ui.instantor.format("insertHTML",wp.media.string.image(e))}})}void 0!==l&&(l=l.split(":"),mpl.ui.instantor.format(l[0],l[1]))}),l.find("select.format").on("change",function(e){mpl.ui.instantor.format("formatblock",this.value)}),mpl.ui.draggable(l.get(0),'i[data-act="move"]'),mpl.add_action("mpl-draggable-end","fgE6td4wS",function(e){mpl.ui.instantor.pos={top:e.data.style.top,left:e.data.style.left}}),this.target(t),l},clickImage:function(t,a){null!==mpl.id("mpl-instantor")&&e("#mpl-instantor").remove(),e("body").append('<div id="mpl-instantor">'+this.imageTmpl+"</div>");var l=e("#mpl-instantor");l.data({el:a}),l.on("click",t.target,function(t){var a=e(t.target).data("act"),l=e(t.target).data("format"),i=t.data;e(this);if(void 0!==l)return mpl.ui.instantor.format(l,null);if("removeimage"==a){"A"==i.parentNode.tagName&&(i=i.parentNode);var o=mpl.ui.instantor.selection(),n=mpl.ui.instantor.range();o.removeAllRanges(),n.selectNode(i),o.addRange(n),mpl.ui.instantor.format("delete",null),e(this).data("el").setAttribute("data-live-editor",""),e(this).remove()}"changeimage"==a&&mpl.tools.media.opens({data:function(t){"A"==i.parentNode.tagName&&(i=i.parentNode);var a=mpl.ui.instantor.selection(),l=mpl.ui.instantor.range();a.removeAllRanges(),l.selectNode(i),a.addRange(l),mpl.ui.instantor.format("delete",null),mpl.ui.instantor.format("insertHTML",wp.media.string.image(t)),e("#mpl-instantor").data("el").setAttribute("data-live-editor",""),e("#mpl-instantor").remove()}})}),l.find('input[data-act="imagewidth"]').val(t.target.getAttribute("width")).on("change",t.target,function(e){void 0!==e.data.getAttribute("height")&&e.data.removeAttribute("height"),e.data.setAttribute("width",this.value.replace(/\D/g,""))}),l.addClass("imgclick").css({top:t.clientY+"px",left:t.clientX-l.width()/2+"px"})},possition:function(t,a,l){if(null!==mpl.id("mpl-instantor")){if(!1===l&&void 0!==mpl.ui.instantor.pos)return void e("#mpl-instantor").css(mpl.ui.instantor.pos);var i=a.getBoundingClientRect(),o=i.left+i.width/2-187,n=i.top>100?i.top:100;e("#mpl-instantor").css({top:n+"px",left:o+"px"})}},target:function(t){if(null!==mpl.id("mpl-instantor")){var a=t.target,l=e("#mpl-instantor");for(l.data({clicked:t.target}),l.find("i").removeClass("active");null!==a&&null===a.getAttribute("contenteditable");){switch(a.tagName){case"I":l.find('i[data-format="italic"]').addClass("active");break;case"B":l.find('i[data-format="bold"]').addClass("active");break;case"U":l.find('i[data-format="underline"]').addClass("active");break;case"BLOCKQUOTE":l.find('i[data-format="formatblock:blockquote"]').addClass("active");break;case"A":l.find('i[data-act="insertlink"]').addClass("active");break;case"OL":l.find('i[data-format="insertorderedlist"]').addClass("active");break;case"UL":l.find('i[data-format="insertunorderedlist"]').addClass("active");break;case"STRIKE":l.find('i[data-format="strikethrough"]').addClass("active")}switch(a.style.textAlign){case"left":l.find('i[data-format="justifyleft"]').addClass("active");break;case"center":l.find('i[data-format="justifycenter"]').addClass("active");break;case"right":l.find('i[data-format="justifyright"]').addClass("active");break;case"justify":l.find('i[data-format="justifyfull"]').addClass("active")}a=a.parentNode}}},format:function(t,a){if(null!==mpl.id("mpl-instantor")){var l=this.elmAtRange(),i=e("#mpl-instantor").data("el");"formatblock"==t&&null!==l&&e(l).closest(a.toLowerCase()).length>0&&(a="<p>"),void 0!==mpl.front?mpl.frame.doc.execCommand(t,!1,a):document.execCommand(t,!1,a),void 0!==i&&i.focus()}},elmAtRange:function(){try{var e=this.selection().getRangeAt(0);if(0!==e){var t=e.commonAncestorContainer;return 1!=t.nodeType&&(t=t.parentNode),t}}catch(e){}return null},selection:function(){if(void 0!==mpl.front)return mpl.frame.doc.getSelection();document.getSelection()},range:function(){if(void 0!==mpl.front)return mpl.frame.doc.createRange();document.createRange()},clearformat:function(){var t="",a=this.selection();if(a.rangeCount){for(var l=document.createElement("p"),i=0,o=a.rangeCount;i<o;++i)l.appendChild(a.getRangeAt(i).cloneContents());t=l.innerText}if(""!==t)this.format("delete",null),this.format("insertHTML","<p>"+t+"</p>");else{var n=this.selection().getRangeAt(0).startContainer.parentNode,s=n.innerText;if("P"!==n.tagName){"LI"==n.tagName&&(s=(n=n.parentNode).innerText);var r=this.selection(),p=this.range();r.removeAllRanges(),p.selectNode(n),r.addRange(p),this.format("delete",null),e(n).remove(),this.format("insertHTML","<p>"+s+"</p>")}}}}}},window.mpl),window.mpl.ui=e.extend({sections:{render:function(t){var a={pop:t},l=e(mpl.template("sections",a)),i=l.find("img");t.find(".m-p-body").html(l),"function"==typeof a.callback&&a.callback(l,e,a),mpl.tools.popup.callback(t,{cancel:function(e,t){mpl.sections.scroll_top=e.find(".m-p-body").scrollTop()}},"dgRw26e"),mpl.sections.imags_total=i.length,mpl.sections.imags_ready=0,i.each(function(){this.onload=function(){mpl.sections.imags_ready++,mpl.sections.imags_ready==mpl.sections.imags_total&&(new Masonry(l.get(0),{itemSelector:".mpl-sections-item",columnWidth:".mpl-sections-item"}),t.find(".m-p-body").scrollTop(mpl.sections.scroll_top))}})},render_callback:function(e,t,a){a.pop.find("h3.m-p-header .mpl-section-control").remove(),mpl.trigger({el:e.find(".mpl-section-control"),events:{".reload:click":mpl.ui.sections.reload,".content-type:change":"type",".category:change":"category",".mpl-add-new-section:click":"add_new",".more-options ul.items-per-page li:click":"per_page",".more-options ul.grid-columns li:click":"columns",".keyword:keyup":"keyword"},type:function(e){mpl.cfg.sectionsType=t(this).val(),mpl.cfg.sectionsTerm="",e.data.el.find(".category").val(""),mpl.ui.sections.reload(e),mpl.backbone.stack.set("MPL_Configs",mpl.cfg)},category:function(e){mpl.cfg.sectionsTerm=t(this).val(),mpl.ui.sections.reload(e),mpl.backbone.stack.set("MPL_Configs",mpl.cfg)},add_new:function(e){var a=mpl.get.popup(e.target),l="";if(0===a.find(".mpl-section-control select.content-type").val().indexOf("prebuilt-templates-("))return alert(mpl.__.i71),!1;if(a.hasClass("mpl-save-row-to-section")){if(void 0!==mpl.front)l=mpl.front.build_shortcode(a.data("model"));else if("all"==a.data("model")){var i;if(t("#mpl-container > #mpl-rows > .mpl-row").each(function(){i=mpl.backbone.export(t(this).data("model")),l+=i.begin+i.content+i.end}),""===l)return alert("__EMPTY_ERROR"),!1}else l=mpl.backbone.export(a.data("model")),l=l.begin+l.content+l.end;return mpl.backbone.stack.set("MPL_RowNewSection",l),a.find(".sl-close").trigger("click"),window.open(t(this).attr("href")+"&mpl_action=content_from_row"),e.preventDefault(),!1}return!0},per_page:function(e){t(this).parent().find(".active").removeClass("active"),t(this).addClass("active"),mpl.cfg.sectionsPerpage=t(this).data("amount"),mpl.ui.sections.reload(e),mpl.backbone.stack.set("MPL_Configs",mpl.cfg)},columns:function(e){t(this).parent().find(".active").removeClass("active"),t(this).addClass("active"),mpl.sections.cols=t(this).data("amount"),mpl.cfg.sectionsLayout=t(this).data("amount"),mpl.ui.sections.render(a.pop),mpl.backbone.stack.set("MPL_Configs",mpl.cfg)},keyword:function(e){if(13===e.keyCode)return mpl.ui.sections.reload(e),e.preventDefault(),!1}}),mpl.trigger({el:e.find(".mpl-section-share"),events:{".mpl-ss-share-submit:click":"share",".mpl-ss-share-cancel:click":"cancel_share"},share:function(e){},cancel_share:function(e){return t(this).closest(".mpl-section-share").hide(),e.preventDefault(),!1}}),e.on("click",function(e){switch(t(e.target).data("action")){case"link":mpl.do_action("mpl-link-section",e);break;case"clone":mpl.do_action("mpl-clone-section",e);break;case"push":mpl.ui.sections.push(e,!1);break;case"overwrite":mpl.ui.sections.push(e,!0);break;case"delete":mpl.ui.sections.delete(e);break;case"page":mpl.ui.sections.page(e);break;case"prebuilt":mpl.ui.sections.prebuilt(e);break;case"share":mpl.ui.sections.share(e)}}),e.find(".pages-select select").on("change",function(e){mpl.ui.sections.reload(e,this.value)}),a.pop.find("h3.m-p-header").append(e.find(".mpl-section-control")),a.pop.hasClass("mpl-save-row-to-section")&&a.pop.find(".mpl-section-control select.content-type option[value^='prebuilt-templates-']").remove()},reload:function(t,a,l){var i=t.target?mpl.get.popup(t.target):t,o=i.find(".mpl-section-control .keyword").val(),n=i.find(".mpl-section-control .category").val(),s=i.find(".mpl-section-control .content-type").val(),r=i.find(".mpl-section-control .more-options .items-per-page li.active").data("amount"),p=i.find(".mpl-section-control .more-options .grid-columns li.active").data("amount");void 0===r&&void 0!==mpl.cfg.sectionsPerpage&&(r=mpl.cfg.sectionsPerpage),void 0===p&&void 0!==mpl.cfg.sectionsLayout&&(p=mpl.cfg.sectionsLayout),void 0===n&&void 0!==mpl.cfg.sectionsTerm&&(n=mpl.cfg.sectionsTerm),void 0===s&&void 0!==mpl.cfg.sectionsType&&(s=mpl.cfg.sectionsType),void 0===a&&(a=1),i.find(".m-p-wrap.wp-pointer-content").append('<div class="mpl-popup-loading" style="display:block"><span class="mpl-loader"></span></div>'),e.ajax({url:ajaxurl,data:{security:mpl_ajax_nonce,action:"mpl_load_sections",s:o,term:n,type:s,paged:a,per_page:r,cols:p,isdelete:l},pop:i,method:"POST",dataType:"json",success:function(t){this.pop.find(".mpl-popup-loading").remove(),-1!==t&&"-1"!=t?(mpl.sections=t.data,mpl.ui.sections.render(this.pop),1!==t.stt&&this.pop.find(".m-p-body").html('<div class="align-center">'+t.message+"</div>"),this.pop.find(".m-p-body").css({"overflow-x":"hidden"}),mpl.trigger({el:e(".mpl-templates"),events:{".mpl-template-import:click":"import",".mpl-templates-categories li:click":"categories"},import:function(t){var a=e(this).data("name"),l=e(this).data("rule"),i=e(this).parents(".mpl-template-item").find(".cpdes").text();void 0!==l&&"pro"==l?mpl.msg(i+' only available in pro version.<br/><a style="margin-top:20px;" class="button button-primary" href="https://www.mageewp.com/peony-theme.html" target="_blank">Get Peony Pro</a>',"MPL Pro Support","sl-close",3e3):e.ajax({url:mpl_ajax_url,method:"POST",dataType:"json",data:{action:"mpl_get_template",template:a},success:function(t){var a=mpl._$;if(mpl.front&&void 0!==t.fonts&&(mpl_fonts=JSON.parse(t.fonts)),mpl.front&&void 0!==t.html){for(var l=mpl.front.id+1,i=a(t.html),o=0,n=0;n<i.length;n++)if("STYLE"==i[n].tagName){var s=a(i[n]).html(),r=a("#mpl-css-render").html();a("#mpl-css-render").html(r+s),o=n}else{var p=a(i[n]).attr("class");p&&(p.indexOf("mpl-elm")>-1?a(i[n]).attr("data-front-model",l++):a(i[n]).find(".mpl-elm").attr("data-front-model",l++))}i.splice(o,1),a(".mpl-content-wrap").append(i),e("#mpl-live-frame").get(0).contentWindow.mpl_front.init(a),mpl.front.addToolsListener()}e(".save-post-settings").trigger("click"),mpl.backbone.push(t.content),e(".mpl-params-popup").remove(),a("html").css({overflow:"scroll"})}})},categories:function(t){var a=e(this).data("category");e(this).parent().find(".active").removeClass("active"),e(this).addClass("active"),"all"===a?e(".mpl-templates>.mpl-templates-list").find("li[data-category]").show():(e(".mpl-templates>.mpl-templates-list").find("li[data-category]").hide(),e(".mpl-templates>.mpl-templates-list").find('li[data-category="'+a+'"]').show())}})):mpl.msg(mpl.__.security,"error","sl-close")}})},link:function(t){var a=e(t.target).closest(".mpl-sections-item").data("id");if(title=e(t.target).closest(".mpl-sections-item").data("title"),pop=mpl.get.popup(t.target),model=pop.data("model"),void 0===window.mpl_post_id||window.mpl_post_ID!=a)if(pop.find("button.cancel").trigger("click"),void 0!==model&&null!==model){var l=e("#mpl-rows #model-"+model);mpl.storage[model].args.__section_link=a,mpl.storage[model].args.__section_title=title;var i=mpl.views.row.render(mpl.storage[model]);l.after(i).remove(),mpl.ui.scrollAssistive(i)}else mpl.backbone.push('[mpl_row __section_link="'+a+'" __section_title="'+title+'"][/mpl_row]');else mpl.msg(mpl.__.i62,"error","sl-close",5e3)},clone:function(t){var a=e(t.target).closest(".mpl-sections-item").data("id");mpl.get.popup(t.target,"close").trigger("click"),mpl.msg(mpl.__.processing,"loading"),e.ajax({url:ajaxurl,data:{security:mpl_ajax_nonce,action:"mpl_load_section",id:a},method:"POST",dataType:"json",success:function(t){-1!==t&&"-1"!=t?1===t.stt?(mpl.backbone.push(t.data),e("#mpl-preload").remove()):mpl.msg(t.message,"error","sl-close"):mpl.msg(mpl.__.security,"error","sl-close")}})},push:function(t,a){var l=mpl.get.popup(t.target).data("model"),i=e(t.target).closest(".mpl-sections-item").data("id"),o="";if(void 0!==mpl.front)o=mpl.front.build_shortcode(l);else if("all"==l){var n;if(e("#mpl-container > #mpl-rows > .mpl-row").each(function(){n=mpl.backbone.export(e(this).data("model")),o+=n.begin+n.content+n.end}),""===o)return alert("__EMPTY_ERROR"),!1}else o=mpl.backbone.export(l),o=o.begin+o.content+o.end;mpl.get.popup(t.target,"close").trigger("click"),mpl.msg(mpl.__.processing,"loading"),e.ajax({url:ajaxurl,data:{security:mpl_ajax_nonce,action:"mpl_push_section",content:o,id:i,overwrite:a?"true":"false"},method:"POST",dataType:"json",success:function(e){-1!==e&&"-1"!=e?1===e.stt?mpl.msg(e.message,"success","sl-check"):mpl.msg(e.message,"error","sl-close"):mpl.msg(mpl.__.security,"error","sl-close")}})},delete:function(t){if(confirm(mpl.__.sure)){var a=e(t.target).closest(".mpl-sections-item").data("id");this.reload(t,1,a)}return t.preventDefault(),!1},page:function(t){var a=e(t.target),l=(a.html(),a.closest(".mpl-section-pagination").find(".active"));"next"==a.data("page")?"next"!=l.next().data("page")&&mpl.ui.sections.reload(t,l.next().html()):"prev"==a.data("page")?"prev"!=l.prev().data("page")&&mpl.ui.sections.reload(t,l.prev().html()):a.hasClass("active")||mpl.ui.sections.reload(t,a.html())},prebuilt:function(t){var a=e(t.target).closest(".mpl-sections-item").data("id"),l=e(t.target).closest(".mpl-params-popup").find(".mpl-section-control select.category").val();mpl.get.popup(t.target,"close").trigger("click"),mpl.msg(mpl.__.processing,"loading"),e.ajax({url:ajaxurl,data:{security:mpl_ajax_nonce,action:"mpl_load_section",id:a,xml_pack:l},method:"POST",dataType:"json",success:function(t){if(-1!==t&&"-1"!=t)if(1===t.stt){if(mpl.backbone.push(t.data),"object"==typeof t.meta)for(var a in t.meta)""!==t.meta[a]&&e("#mpl-page-cfg-"+a).length>0&&e("#mpl-page-cfg-"+a).val(t.meta[a]);e("#mpl-preload").remove()}else mpl.msg(t.message,"error","sl-close");else mpl.msg(mpl.__.security,"error","sl-close")}})},share:function(t){var a=e(t.target).closest(".mpl-sections-item").data("id"),l=e(t.target).closest(".mpl-section-info").find(">span").html(),i=e(t.target).closest(".mpl-sections-item").find(">.mpl-section-sceenshot img").attr("src"),o=e(t.target).closest("#mpl-sections").find(".mpl-section-share");return e(t.target).closest(".m-p-body").scrollTop("1px"),o.show().find(".mpl-ss-section span").html(l),o.find(".mpl-ss-thumbnail").html('<img src="'+i+'" />'),o.data({id:a,label:l}),o.find(".mpl-ss-name input,.mpl-ss-email input").val("").first().focus(),e("#mpl-sections").height()<550&&e("#mpl-sections").height("550px"),t.preventDefault(),!1}}},window.mpl.ui),window.mpl.ui=e.extend({sortInit:function(){setTimeout(function(){if(mpl.ui.sortable({items:".mpl-element.mpl-model,.mpl-views-sections.mpl-model,.mpl-row-inner.mpl-model,.mpl-element.drag-helper",connecting:!0,handle:">ul>li.move",helper:["mpl-ui-handle-image",25,25],detectEdge:80,start:function(t,a){e("#mpl-undo-deleted-element").addClass("drop-to-delete");var l=e(a),i={parent:l.parent().get(0)};l.next().hasClass("mpl-model")&&(i.next=l.next().get(0)),l.prev().hasClass("mpl-model")&&(i.prev=l.prev().get(0)),l.data({relate2:i})},end:function(){e("#mpl-undo-deleted-element").removeClass("drop-to-delete")}}),!0!==document.getElementById("drop-to-delete").droppable){var t=document.getElementById("drop-to-delete");t.setAttribute("droppable","true"),t.setAttribute("draggable","true");var a={dragover:function(e){return e.dataTransfer.dropEffect="copy",this.className="over",e.preventDefault(),!1},dragleave:function(e){return e.preventDefault(),this.className="",!1},drop:function(t){if(this.className="",e("#mpl-undo-deleted-element").removeClass("drop-to-delete"),null!==mpl.ui.elm_drag){var a=e(mpl.ui.elm_drag).data("atts");e(mpl.ui.elm_drag).removeClass(a.placeholder).find("li.delete").first().trigger("click"),e(mpl.ui.elm_drag).data({relate:e(mpl.ui.elm_drag).data("relate2")}),t.preventDefault()}}};for(var l in a)t.addEventListener(l,a[l],!1)}mpl.ui.sortable({items:"#mpl-rows>.mpl-row",vertical:!0,connecting:!1,handle:">ul>li.move",helper:["mpl-ui-handle-image",25,25],start:function(){e("#mpl-rows").addClass("sorting")},end:function(){e("#mpl-rows").removeClass("sorting")}}),mpl.ui.sortable({items:".mpl-column,.mpl-column-inner",vertical:!1,connecting:!1,handle:">.mpl-column-control",helper:["mpl-ui-handle-image",25,25],detectEdge:"auto",start:function(t,a){e(a).parent().addClass("mpl-sorting")},end:function(t,a){e(a).parent().removeClass("mpl-sorting")}})},100)},sortable_events:{mousedown:function(t){if(void 0===window.chrome&&!0!==this.draggable){var a,l=e(this).data("atts");void 0!==l.handle&&""!==l.handle&&(a=e(this).find(l.handle)).length>0&&(t.target==a.get(0)||e.contains(a.get(0),t.target))&&(this.draggable=!0,mpl.ui.sortable_events.dragstart(t))}},dragstart:function(t){if(null===mpl.ui.elm_start)return t.preventDefault(),!1;mpl.ui.over_delay=!0;var a,l=e(this).data("atts");if(!0==(""===l.handle||void 0===l.handle||(a=e(this).find(l.handle)).length>0&&!(mpl.ui.elm_start!=a.get(0)&&!e.contains(a.get(0),mpl.ui.elm_start)))){e("body").addClass("mpl-ui-dragging"),e(this).closest(".mpl-prevent-scroll").length>0&&e(this).closest(".mpl-prevent-scroll").off("mousewheel DOMMouseScroll"),""!==l.helperClass&&e(mpl.ui.elm_start).closest(l.items).get(0)==this&&e(mpl.ui.elm_start).closest(l.items).addClass(l.helperClass),mpl.ui.elm_drag=this;var i=e(this).prev(),o=e(this).next();i&&(mpl.ui.elm_prev=i),o&&(mpl.ui.elm_next=o),void 0!==t.dataTransfer&&"function"==typeof t.dataTransfer.setData&&t.dataTransfer.setData("text/plain",""),"object"==typeof l.helper&&void 0!==t.dataTransfer&&"function"==typeof t.dataTransfer.setDragImage&&t.dataTransfer.setDragImage(document.getElementById(l.helper[0]),l.helper[1],l.helper[2]),"function"==typeof l.start&&l.start(t,this)}else{for(var n=mpl.ui.elm_start;!0!==n.draggable&&"BODY"!=n.tagName;)n=n.parentNode;if(n==this)return t.preventDefault(),!1}},dragover:function(t){var a=mpl.ui;if(null===a.elm_drag)return t.preventDefault(),!1;if(!1===a.over_delay)return null===a.over_timer&&(a.over_timer=setTimeout(function(){mpl.ui.over_delay=!0,mpl.ui.over_timer=null},50)),!1;a.over_delay=!1,a.elm_over=this;var l=e(this).data("atts"),i=e(a.elm_drag).data("atts");if(t||(t=window.event),this==a.elm_drag||e.contains(a.elm_drag,this)||l.items!=i.items)return t.preventDefault(),!1;var o=this.getBoundingClientRect();if(!1===i.connecting&&this.parentNode!=a.elm_drag.parentNode)return t.preventDefault(),!1;var n=i.detectEdge;return!0===i.vertical?((void 0===n||"auto"==n||n>o.height/2)&&(n=o.height/2),o.bottom-t.clientY<n?(this.nextElementSibling!=a.elm_drag&&(e(this).after(a.elm_drag),!1!==i.preventFlicker&&mpl.ui.preventFlicker(t,a.elm_drag)),"function"==typeof i.over&&i.over(t,this)):t.clientY-o.top<n&&(this.previousElementSibling!=a.elm_drag&&(e(this).before(a.elm_drag),!1!==i.preventFlicker&&mpl.ui.preventFlicker(t,a.elm_drag)),"function"==typeof i.over&&i.over(t,this))):((void 0===n||"auto"==n||n>o.width/2)&&(n=o.width/2),o.right-t.clientX<n?(this.nextElementSibling!=a.elm_drag&&e(this).after(a.elm_drag),"function"==typeof i.over&&i.over(t,this)):t.clientX-o.left<n&&(this.previousElementSibling!=a.elm_drag&&e(this).before(a.elm_drag),"function"==typeof i.over&&i.over(t,this))),t.preventDefault(),!1},drag:function(t){var a=e(this).data("atts"),l=a.helperClass,i=a.placeholder,o=mpl.ui.elm_drag;return""!==l&&null!==o&&o.className.indexOf(l)>-1&&(e(o).removeClass(l),""!==i&&e(o).addClass(i)),"function"==typeof a.drag&&a.drag(t,this),t.preventDefault(),!1},dragleave:function(t){var a=e(this).data("atts");return"function"==typeof a.leave&&a.leave(t,this),t.preventDefault(),!1},dragend:function(t){var a=e(this).data("atts");return e(this).removeClass(a.helperClass),e(this).removeClass(a.placeholder),mpl.ui.elm_drag=null,mpl.ui.elm_over=null,mpl.ui.elm_start=null,mpl.ui.key_down=!1,e("body").removeClass("mpl-ui-dragging"),"function"==typeof a.end&&a.end(t,this),t.preventDefault(),!1},drop:function(t){var a=e(this).data("atts");return"function"==typeof a.drop&&a.drop(t,this),t.preventDefault(),!1}},sortable:function(t){if(""!==(t=e().extend({items:"",handle:"",helper:"",helperClass:"mpl-ui-helper",placeholder:"mpl-ui-placeholder",vertical:!0,connecting:!1,detectEdge:50,preventFlicker:!1},t)).items){var a=document.querySelectorAll(t.items);[].forEach.call(a,function(a){if(!0!==a.draggable){a.setAttribute("droppable","true"),a.setAttribute("draggable","true"),e(a).data({atts:t});for(var l in mpl.ui.sortable_events)a.addEventListener(l,mpl.ui.sortable_events[l],!1)}})}},draggable:function(t,a){if(void 0!==t){var l={mousedown:function(t){if(void 0!==t.which&&1!==t.which)return!1;if("true"==t.target.getAttribute("data-prevent-drag"))return!1;if(""!==this.handle&&void 0!==this.handle&&t.target!=e(this).find(this.handle).get(0)&&0===e(t.target).closest(this.handle).length)return!1;if("INPUT"==t.target.tagName)return!1;e("html,body").addClass("mpl_dragging noneuser"),mpl.do_action("mpl-draggable-start",this,t);var a=this.getBoundingClientRect(),l=mpl.ui.scroll(),i=a.left,o=a.top,n=window.getComputedStyle(this);this.pos=[t.clientY-a.top,t.clientX-a.left],this.position=n.getPropertyValue("position"),this.transform=n.getPropertyValue("transform"),"string"==typeof this.transform&&0===this.transform.indexOf("matrix")&&(this.transform=this.transform.replace("matrix(","").replace(")","").replace(/\ /g,"").split(","),void 0!==this.transform[4]&&(i-=parseFloat(this.transform[4]),this.pos[1]+=parseFloat(this.transform[4])),void 0!==this.transform[5]&&(o-=parseFloat(this.transform[5]),this.pos[0]+=parseFloat(this.transform[5]))),"fixed"!=this.position&&(i+=l.left,o+=l.top-mpl.html.offsetTop),e(this).css({position:"fixed"!=this.position?"absolute":"fixed",top:o+"px",left:i+"px"}),e(document).off("mousemove").on("mousemove",this,function(e){var t=mpl.ui.scroll(),a=e.clientX,l=e.clientY;"fixed"!=e.data.position&&(a+=t.left,l+=t.top-mpl.html.offsetTop),l<e.data.pos[0]&&(l=e.data.pos[0]),e.data.style.top=l-e.data.pos[0]+"px",e.data.style.left=a-e.data.pos[1]+"px",mpl.do_action("mpl-draggable-move",e)}),e(window).off("mouseup").on("mouseup",this,function(t){e(document).off("mousemove"),e(window).off("mouseup"),e("html,body").removeClass("mpl_dragging noneuser"),mpl.do_action("mpl-draggable-end",t)})}};if(!0!==t.kcdraggable){t.kcdraggable=!0,t.handle=a;for(var i in l)t.addEventListener(i,l[i],!1)}}},preventFlicker:function(e,t){if(void 0!==t){var a=t.getBoundingClientRect(),l=0;e.clientY<a.top?l=a.top-e.clientY+a.height/10:e.clientY>a.top+a.height&&(l=-(e.clientY-(a.top+a.height)+a.height/10)),0!==l&&(mpl.body.scrollTop+=l,mpl.html.scrollTop+=l)}},mouses:{load:function(){e("#mpl-container").length>0&&(e("#mpl-container").off("mousedown").on("mousedown",this.down).get(0).oncontextmenu=function(t){return 0==e(t.target).closest(".mpl-model").length&&0==e(t.target).closest(".mpl-right-click-dialog").length})},down:function(t){if(t.button,void 0!==t.which&&1!==t.which)return!1;if(e(".mpl-params-popup:not(.preventCancel) .m-p-header .sl-close").trigger("click"),e("html,body").stop(),t.target.className.indexOf("mpl-add-elements-inner")>-1)return mpl.backbone.add(t.target),t.preventDefault(),!1;if(-1!=t.target.className.indexOf("column-resize")){var a=mpl.ui.mouses,l=e(t.target).parent();e(document).on("mouseup",a.up),e(document).on("mousemove",{el:l,pel:l.prev(),nel:l.next(),emodel:l.data("model"),nmodel:l.next().data("model"),pmodel:l.prev().data("model"),einfo:l.find(">.mpl-cols-info"),ninfo:l.next().find(">.mpl-cols-info"),pinfo:l.prev().find(">.mpl-cols-info"),left:t.clientX,width:parseFloat(t.target.parentNode.style.width),nwidth:parseFloat(e(t.target.parentNode).next().get(0)?e(t.target.parentNode).next().get(0).style.width:0),pwidth:parseFloat(e(t.target.parentNode).prev().get(0)?e(t.target.parentNode).prev().get(0).style.width:0),direct:e(t.target).hasClass("cr-left"),offset:1},a.move),e("body").addClass("mpl-column-resizing").css({cursor:"col-resize"}),e(window).off("mouseup").on("mouseup",function(){e(document).off("mousemove"),e(window).off("mouseup"),e("html,body").removeClass("mpl_dragging noneuser")})}},up:function(t){e(document).off("mousemove").off("mouseup"),e("body").removeClass("mpl-column-resizing").css({cursor:""})},move:function(e){e.preventDefault(),e.data.offset=e.clientX-e.data.left;var t=e.data,a=parseFloat(t.el.get(0).style.width)/t.el.get(0).offsetWidth,l=t.width-t.offset*a,i=t.pwidth+t.offset*a,o=t.width+t.offset*a,n=t.nwidth-t.offset*a;t.direct?l>9&&i>9&&(t.el.width(l+"%"),t.pel.width(i+"%"),t.einfo.html(Math.round(l)+"%"),t.pinfo.html(Math.round(i)+"%"),mpl.storage[t.emodel].args.width=mpl.tools.nfloat(l)+"%",mpl.storage[t.pmodel].args.width=mpl.tools.nfloat(i)+"%"):o>9&&n>9&&(t.el.width(o+"%"),t.nel.width(n+"%"),t.einfo.html(Math.round(o)+"%"),t.ninfo.html(Math.round(n)+"%"),mpl.storage[t.emodel].args.width=mpl.tools.nfloat(o)+"%",mpl.storage[t.nmodel].args.width=mpl.tools.nfloat(n)+"%")}}},window.mpl.ui),window.mpl.ui=e.extend({callbacks:{upload_image:function(e,t){e.find(".media").on("click",{callback:function(a){var l=t(this.el).closest(".mpl-attach-field-wrp"),i=a.url;l.find("input.mpl-param").val(a.id).change(),"object"==typeof a.sizes.medium&&(i=a.sizes.medium.url),l.find("img").get(0)?l.find("img").attr({src:i}):(l.prepend('<div class="img-wrp"><img src="'+i+'" alt="" /><i title="'+mpl.__.i50+'" class="sl-close"></i></div>'),l.find("img").on("click",e,function(t){e.find(".media").trigger("click")}),l.find("div.img-wrp .sl-close").on("click",e,function(e){e.data.find("input.mpl-param").val("").change(),t(this).closest("div.img-wrp").remove()}))},atts:{frame:"select"}},mpl.tools.media.open),e.find("div.img-wrp .sl-close").on("click",e,function(e){e.data.find("input.mpl-param").val("").change(),t(this).closest("div.img-wrp").remove()}),e.find("div.img-wrp img").on("click",e,function(t){e.find(".media").trigger("click")})},upload_image_url:function(e,t){e.find(".media").on("click",{callback:function(a){var l=t(this.el).closest(".mpl-attach-field-wrp"),i=a.url;void 0!==a.size&&null!==a.size&&void 0!==a.sizes[a.size]?i=a.sizes[a.size].url:"object"==typeof a.sizes.medium&&(i=a.sizes.medium.url),void 0!==i&&""!==i&&l.find("input[data-mpl-param]").val(i).change(),l.find("img").get(0)?(l.find("img").attr({src:i}),l.find(".img-sizes").html("")):(l.prepend('<div class="img-wrp"><img src="'+i+'" alt="" /><i title="'+mpl.__.i50+'" class="sl-close"></i><div class="img-sizes"></div></div>'),e.find("div.img-wrp img").on("click",e,function(t){e.find(".media").trigger("click")}),e.find("div.img-wrp .sl-close").on("click",e,function(e){t(this).closest("div.img-wrp").remove(),e.data.find("input[data-mpl-param]").val("").change()}));var o,n=l.find(".img-sizes");for(var s in a.sizes)o=t('<button data-url="'+a.sizes[s].url+'" class="button">'+a.sizes[s].width+"x"+a.sizes[s].height+"</button>"),void 0!==a.size&&a.size?a.size==s&&o.addClass("button-primary"):"medium"==s&&o.addClass("button-primary"),o.on("click",function(e){var a=t(this).closest(".mpl-attach-field-wrp"),l=t(this).data("url");return t(this).parent().find("button").removeClass("button-primary"),t(this).addClass("button-primary"),a.find("img").attr({src:l}),a.find("input[data-mpl-param]").val(l).change(),e.preventDefault(),!1}),n.append(o)},atts:{frame:"post"}},mpl.tools.media.open),e.find("div.img-wrp .sl-close").on("click",e,function(e){t(this).closest("div.img-wrp").remove(),e.data.find("input[data-mpl-param]").val("").change()}),e.find("div.img-wrp img").on("click",e,function(t){e.find(".media").trigger("click")})},upload_images:function(e){function t(e){mpl.ui.sortable({items:"div.mpl-attach-field-wrp>div.img-wrp",helper:["mpl-ui-handle-image",25,25],connecting:!1,vertical:!1,end:function(e,t){a(jQuery(t).closest(".mpl-attach-field-wrp"))}}),e.find("div.img-wrp i.sl-close").off("click").on("click",e,function(e){jQuery(this).closest("div.img-wrp").remove(),a(e.data)}),a(e)}function a(e){var t=[];e.find("div.img-wrp").each(function(){t[t.length]=jQuery(this).data("id")}),t.length<=4?e.removeClass("img-wrp-medium").removeClass("img-wrp-large"):t.length>4&&t.length<9?e.addClass("img-wrp-medium").removeClass("img-wrp-large"):t.length>=9&&e.removeClass("img-wrp-medium").addClass("img-wrp-large"),e.find("input.mpl-param").val(t.join(",")).change(),e.find("div.img-wrp img").on("click",e,function(t){e.find(".media").trigger("click")})}e.find(".media").on("click",function(e){var a=jQuery(this.els).closest(".mpl-attach-field-wrp"),l=e.url;"object"==typeof e.sizes.thumbnail&&(l=e.sizes.thumbnail.url),a.prepend('<div data-id="'+e.id+'" class="img-wrp"><img title="Drag image to sort" src="'+l+'" alt="" /><i title="'+mpl.__.i50+'" class="sl-close"></i></div>'),t(a)},mpl.tools.media.opens),t(e.find(".mpl-attach-field-wrp"))},select_group:function(e,t){e.find("button").on("click",e,function(e){return e.data.find("input").val(this.getAttribute("data-value")).trigger("change"),e.data.find("button.active").removeClass("active"),t(this).addClass("active"),e.preventDefault(),!1})},number:function(e,t){e.find("input[type=number]").on("mousedown",function(e){if(void 0!==e.which&&1!==e.which)return!1;t(document).on("mouseup",function(){t(document).off("mousemove").off("mouseup"),t("body").removeClass("noneuser").css({cursor:""})}),t(document).on("mousemove",{el:this,cur:parseInt(""!==this.value?this.value:0,10),top:e.clientY},function(e){var a=Math.round((e.clientY-e.data.top)/2);e.data.el.value=e.data.cur-a,t(e.data.el).trigger("change")}),t("body").css({cursor:"ns-resize"}),t(window).off("mouseup").on("mouseup",function(){t(document).off("mousemove"),t(window).off("mouseup"),t("html,body").removeClass("mpl_dragging noneuser")})}).on("change",function(){var e=t(this).parent().find("li.active").html(),a=this.value;""!==a&&(a+=e),t(this).parent().find("input[type=hidden]").val(a).trigger("change")}),e.find("ul li").on("click",function(){t(this).parent().find(".active").removeClass("active"),t(this).addClass("active");var e=t(this).closest(".m-p-r-content").find("input[type=hidden]"),a=e.val().replace(/[^0-9\.]/g,"");""!==a&&(a+=this.innerHTML),e.val(a).trigger("change")})},number_slider:function(e,t,a){var l=e.find(".mpl_percent_slider"),i=a.value.toString().split("|"),o={range:void 0!==a.options.range&&a.options.range,unit:void 0===a.options.unit?"":a.options.unit,ratio:void 0===a.options.ratio?1:parseFloat(a.options.ratio),min:void 0===a.options.min?0:parseFloat(a.options.min),max:void 0===a.options.max?100:parseFloat(a.options.max),enabled:"enabled"==typeof a.options.max||a.options.enabled,step:1},n=function(e,a){var l=e.data("options");l.onchange=function(t,a){!0===l.range?e.next("input").val(mpl.tools.nfloat(t*l.ratio)+l.unit+"|"+(mpl.tools.nfloat(a*l.ratio)+l.unit)).trigger("change","globe"):e.next("input").val(mpl.tools.nfloat(t*l.ratio)+l.unit).trigger("change","globe"),e.find(".fscaret").text("")},isNaN(a)?l.value=parseFloat(l.max):1===a.length?l.value=parseFloat(a[0])/l.ratio:l.value=[parseFloat(a[0])/l.ratio,parseFloat(a[1])/l.ratio],e.off("mouseup").on("mouseup",function(){t(this).next("input").change()}).freshslider(l)};l.data({options:o});for(var s in i)i[s]=parseFloat(i[s]);n(l,i),l.next("input").on("change",{el:e,el_slider:l,data:a},function(e,a){if(void 0===a||"globe"!=a){var l=t(this).val(),i=e.data.el_slider.data("options");if(/^\d+$/.test(l)&&""!==l){this.value!==l&&t(this).val(parseInt(l,10)),l/i.ratio>i.max&&(l=i.max*i.ratio),l=l.toString().split("|");for(var o in l)l[o]=parseInt(l[o],10)/i.ratio;n(e.data.el_slider,l)}else e.data.el_slider.next("input").val("")}}),l.next("input").val(a.value).trigger("change","globe")},autocomplete:function(e,t,a){function l(e){mpl.ui.sortable({items:"div.mpl_autocomplete_wrp>ul>li",connecting:!1,vertical:!1,end:function(e,a){i(t(a).closest(".mpl_autocomplete_wrp"))}}),e.find("i.mpl-ac-remove").off("click").on("click",e,function(e){t(this).closest("li").remove(),i(e.data)}),i(e)}function i(e){var a=[];e.find(">ul.autcp-items>li").each(function(){a[a.length]=t(this).data("id")+":"+t(this).find(">span").html()}),e.find("input.mpl-param").val(a.join(","))}!function(e,a){var i="",o="any",n="",s="",r="",p=!0;if(void 0!==e.options&&(void 0!==e.options.post_type&&(o=e.options.post_type),void 0!==e.options.category&&(n=e.options.category),void 0!==e.options.category_name&&(s=e.options.category_name),void 0!==e.options.taxonomy&&(r=e.options.taxonomy),void 0!==e.options.multiple&&(p=e.options.multiple)),""!==e.value)for(var d,c,m=e.value.split(","),u=0;u<m.length;u++)c=(d=m[u].split(":"))[0],d=void 0!==d[1]?d[1]:"",i+='<li data-id="'+c+'"><span>'+mpl.tools.esc_attr(d)+'</span><i class="sl-close mpl-ac-remove" title="Remove item"></i></li>';a.find("ul.autcp-items").html(i),l(a.find(".mpl_autocomplete_wrp")),a.find(".mpl-autp-enter").on("focus",function(){t(this.parentNode).find(".mpl-autp-suggestion").show()}).on("blur",function(){setTimeout(function(e){e.hide()},200,t(this.parentNode).find(".mpl-autp-suggestion"))}).on("keyup",function(){""!==this.value&&(0===t(this.parentNode).find(".mpl-autp-suggestion .fa-spinner").length&&t(this.parentNode).find(".mpl-autp-suggestion ul").prepend('<li class="sg-loading mpl-free-scroll"><i class="fa fa-spinner fa-spin"></i> searching...</li>'),clearTimeout(this.timer),this.session=Math.random(),this.timer=setTimeout(function(a){t.post(mpl_ajax_url,{action:"mpl_suggestion",security:mpl_ajax_nonce,post_type:o,category:n,category_name:s,numberposts:120,taxonomy:r,s:a.value,field_name:e.name,session:a.session},function(e){if(t(a.parentNode).find(".sg-loading").remove(),a.session==e.__session){var i,o=[],n=[];for(var s in e)if("__session"!==s){-1===o.indexOf(s)&&(o.push(s),n.push('<li class="label mpl-free-scroll">'+s+"</li>"));for(var r in e[s])i=e[s][r].split(":"),n.push('<li class="mpl-free-scroll" data-multiple="'+p+'"data-value="'+mpl.tools.esc_attr(e[s][r])+'">'+i[1]+"</li>")}0===n.length&&n.push("<li>Nothing found</li>"),t(a.parentNode).find(".mpl-autp-suggestion ul").html(n.join("")).find("li").on("click",function(){var e=t(this).data("value");if(null!==e&&void 0!==e){var a=t(this).closest(".mpl_autocomplete_wrp").find("ul.autcp-items");e=e.split(":"),!1===t(this).data("multiple")&&a.find("i.mpl-ac-remove").trigger("click"),a.append('<li data-id="'+e[0]+'"><span>'+mpl.tools.esc_attr(e[1])+'</span><i class="sl-close mpl-ac-remove" title="Remove item"></i></li>'),l(t(this).closest(".mpl_autocomplete_wrp"))}})}})},250,this))})}(a,e)},taxonomy:function(e,t,a){e.find(".mpl-content-type").on("change",e,function(e){var a=this.value;e.data.find(".mpl-taxonomies-select option").each(function(){this.selected=!1,t(this).hasClass(a)?this.style.display="":this.style.display="none",this.value==a&&(this.checked=!0,e.data.find("input.mpl-param").val(a))})}),e.find(".mpl-taxonomies-select").on("change",e,function(e){var a=[];t(this).find("option:selected").each(function(){a.push(this.value)}),e.data.find("input.mpl-param").val(a.join(","))}),e.find(".unselected").on("click",e,function(e){e.data.find(".mpl-taxonomies-select option:selected").attr({selected:!1}),e.data.find("input.mpl-param").val(""),e.preventDefault()});var l=a.value.split(","),i=a.value+",";l.length>0&&(selected=l[0].split(":")[0],""!==selected?e.find(".mpl-content-type option[value="+selected+"]").attr("selected","selected").trigger("change"):e.find(".mpl-content-type").trigger("change"),e.find(".mpl-taxonomies-select option").each(function(){i.indexOf(this.value+",")>-1?this.selected=!0:this.selected=!1})),e.find(".mpl-select-wrp").append('<input class="mpl-param" name="'+a.name+'" type="hidden" value="'+a.value+'" />')},corners:function(e,t){var a=function(e){var t=[],a=!0;e.find(".mpl-corners-wrp input[data-css-corners]").each(function(){""!==this.value?(t.push(this.value),a=!1):t.push("inherit")}),!0===a&&(t=[]),e.find("input[data-css-corners-value]").val(t.join(" ")).change()};e.find("input[data-css-corners]").on("keyup change",e,function(e){if("px"==this.value.trim()&&(this.value=""),!1===isNaN(this.value)&&(this.value+="px",this.setSelectionRange(this.value.length-2,1)),"px"==this.value.trim()&&(this.value=""),(this.value.indexOf("%")>-1||this.value.indexOf("em")>-1)&&(this.value=this.value.replace(/\p\x/g,"")),t(this).data({unit:this.value.replace(/[^a-z\%]/g,"")}),e.data.find(".m-f-u-li-link").hasClass("active")){var l=this;e.data.find("input[data-css-corners]").each(function(){this!=l&&(this.value=l.value,t(this).data({unit:this.value.replace(/[^a-z\%]/g,"")}))})}a(e.data)}).on("mousedown",function(e){if(void 0!==e.which&&1!==e.which)return!1;t(document).on("mouseup",function(){t(document).off("mousemove").off("mouseup"),t("body").css({cursor:""})}),t(document).on("mousemove",{el:t(this),cur:parseInt(""!==this.value?this.value:0,10),top:e.clientY},function(e){var a=e.clientY-e.data.top;""===e.data.el.val().replace(/[^a-z\%]/g,"")?e.data.el.data({unit:"px"}):e.data.el.data({unit:e.data.el.val().replace(/[^a-z\%]/g,"")}),e.data.el.val(e.data.cur-a+e.data.el.data("unit")),t(e.data.el).trigger("change")}),t("body").css({cursor:"ns-resize"}),t(window).off("mouseup").on("mouseup",function(){t(document).off("mousemove"),t(window).off("mouseup"),t("html,body").removeClass("mpl_dragging noneuser")})}).on("dblclick",function(){t(this).val("").change()}),e.find(".m-f-u-li-link span").on("click",e,function(e){if(t(this).parent().hasClass("active"))t(this).parent().removeClass("active");else{t(this).parent().addClass("active");var a=t(this).closest(".mpl-corners-wrp").find("input[data-css-corners]"),l="";a.each(function(){""!==this.value&&""===l&&(l=this.value)}),a.val(l).trigger("change")}})},background:function(e,t,a){var l=e.find("input[data-css-background],select[data-css-background]"),i={},o=function(e){var t,a={color:"transparent",linearGradient:[""],image:"none",position:"0% 0%",size:"auto",repeat:"repeat",attachment:"scroll",advanced:0,parallax_scrolling:"no"},l=e.data.find("input[data-css-background],select[data-css-background]");if(!0===e.data.find('.field-toggle input[type="checkbox"]').get(0).checked){a.advanced=1;for(var i in a)null!==(t=l.filter('[name="'+i+'"]').val())&&void 0!==t&&""!==t&&t!=a[i]&&("linearGradient"==i?(a[i]=[],e.data.find("input.degrees").length>0&&""!==e.data.find("input.degrees").val()&&a[i].push(e.data.find("input.degrees").val().replace(/[^0-9\-]/g,"")+"deg"),1===e.data.find(".color-row input.grdcolor").length?""!==e.data.find(".color-row input.grdcolor").val()&&a[i].push(e.data.find(".color-row input.grdcolor").val()):e.data.find(".color-row input.grdcolor").each(function(){""!==this.value&&a[i].push(this.value)})):a[i]="image"==i?t.replace(mpl_site_url,"%SITE_URL%"):t)}else null!==(t=l.filter('[name="color"]').val())&&void 0!==t&&""!==t&&t!=a[i]&&(a.color=t);e.data.find("input[data-css-background-value]").val(mpl.tools.base64.encode(JSON.stringify(a))).change()};e.find(".add-more-color").on("click",e,function(e){var a=t('<span class="color-row"><input class="grdcolor" value="" placeholder="Select color" type="search" /><i class="fa-times remove" title="Delete"></i></span>');t(this.parentNode).find(".mpl-param-bg-gradient-colors .color-row").last().after(a);var l=t(this.parentNode).find(".color-row input").last().get(0);return l.color=new jscolor.color(l,{}),e.data.find("input.grdcolor").each(function(){void 0===this.color&&(this.color=new jscolor.color(this,{}))}),a.find("input").first().on("change",e.data,o),e.preventDefault(),!1}),e.find(".custom-degrees").on("click",e,function(e){if(0===t(this.parentNode).find(".degrees-row").length){var a=t('<span class="degrees-row"><input class="degrees" value="90" placeholder="Custom degrees" style="width: 45%" type="search" autocomplete="off" /><i class="fa-times remove" title="Delete"></i></span>');t(this.parentNode).find(".mpl-param-bg-gradient-colors .color-row").last().after(a),a.find("input").on("change",e.data,o),o(e)}return e.preventDefault(),!1}),e.find(".mpl-param-bg-gradient-colors").on("click",e,function(e){e.target.className.indexOf("remove")>-1&&(t(e.target).closest("span").remove(),o(e))}),e.find(".field-toggle input").on("change",e,function(e){!0===this.checked?e.data.find(".mpl-control-field").removeClass("mpl-hidden"):e.data.find(".mpl-control-field").addClass("mpl-hidden"),e.data.find("input[data-css-background]").first().change()}),e.find(".field-attach_image_url").each(function(){mpl.ui.callbacks.upload_image_url(t(this),t)}),e.find(".field-select_group").each(function(){var e=t(this),a=e.find("input[data-css-background]").val();mpl.ui.callbacks.select_group(e,t),void 0!==e&&""!==e&&e.find("button").removeClass("active").filter('[data-value="'+a+'"]').addClass("active")}),l.on("change",e,o);try{i=JSON.parse(mpl.tools.base64.decode(a.value))}catch(e){}i=t.extend({color:"transparent",linearGradient:[""],image:"none",position:"0% 0%",size:"auto",repeat:"repeat",attachment:"scroll",parallax_scrolling:"no"},i);for(var n in i)if(void 0!==i[n]&&"image"==n&&""!==i[n]&&"none"!=i[n]&&(i[n].indexOf("%SITE_URL%")>-1&&(i[n]=i[n].replace("%SITE_URL%",mpl_site_url),-1===i[n].indexOf(mpl_ajax_url)&&(i[n]=mpl_ajax_url+"?action=mpl_get_thumbn&type=filter_url&id="+encodeURIComponent(i[n].replace(mpl_site_url,"")))),e.find(".field-attach_image_url img").attr({src:i[n]}),e.find(".mpl-toggle-field-wrp input").attr({checked:!0}),e.find(".box-bg.mpl-hidden").removeClass("mpl-hidden")),"color"!=n||"rgba(0, 0, 0, 0)"!=i[n]&&"transparent"!=i[n])if("advanced"==n&&1==i[n])e.find('.field-toggle input[type="checkbox"]').attr({checked:!0}),e.find(".box-bg.mpl-hidden").removeClass("mpl-hidden");else if("linearGradient"==n){if("object"==typeof i[n]&&void 0!==i[n][0]){if(i[n][0].indexOf("deg")>-1){if(0===e.find(".degrees-row").length){var s=t('<span class="degrees-row"><input class="degrees" value="'+i[n][0].replace(/[^0-9\-]/g,"")+'" placeholder="Custom degrees" style="width: 45%" type="search" autocomplete="off" /><i class="fa-times remove" title="Delete"></i></span>');e.find(".mpl-param-bg-gradient-colors .color-row").last().after(s),s.on("change",e,o)}i[n]=i[n].slice(1)}e.find(".color-row").find("input.grdcolor").val(i[n][0]);for(var r,p=1;p<i[n].length;p++)r=t('<span class="color-row"><input class="grdcolor" value="'+i[n][p]+'" placeholder="Select color" type="search" style="background:'+i[n][p]+'" /><i class="fa-times remove" title="Delete"></i></span>'),e.find(".mpl-param-bg-gradient-colors .color-row").last().after(r),new jscolor.color(r.find("input").get(0),{}),r.find("input").first().on("change",e,o)}}else"parallax_scrolling"==n?(e.find('[name="'+n+'"]').val(i[n]),e.find('[name="'+n+'"]').on("change",e,o)):(l.filter('[name="'+n+'"]').val(i[n]).parent().find("button").removeClass("active"),l.filter('[name="'+n+'"]').parent().find('button[data-value="'+i[n]+'"]').addClass("active"));else i[n]="",l.filter('[name="'+n+'"]').val("");e.find(".field-color_picker input, input.grdcolor").each(function(){void 0===this.color&&(this.color=new jscolor.color(this,{}))})},video_background:function(e,t,a){var l=e.find("input[data-css-video-background],select[data-css-video-background]"),i={};e.find('.field-toggle input[name="enable_video_bg"]').on("change",e,function(e){!0===this.checked?e.data.find(".mpl-control-field").removeClass("mpl-hidden"):e.data.find(".mpl-control-field").addClass("mpl-hidden")}),e.find('.field-select select[name="video_type"]').on("change",e,function(e){"html5"===this.value?(e.data.find(".mpl-video_url-field").addClass("mpl-hidden"),e.data.find(".mpl-mp4_url-field").removeClass("mpl-hidden"),e.data.find(".mpl-ogv_url-field").removeClass("mpl-hidden"),e.data.find(".mpl-webm_url-field").removeClass("mpl-hidden")):(e.data.find(".mpl-video_url-field").removeClass("mpl-hidden"),e.data.find(".mpl-mp4_url-field").addClass("mpl-hidden"),e.data.find(".mpl-ogv_url-field").addClass("mpl-hidden"),e.data.find(".mpl-webm_url-field").addClass("mpl-hidden"))}),e.find('.field-toggle input[type="checkbox"]').on("change",e,function(e){!0===this.checked?t(this).attr({checked:!0}):t(this).attr({checked:!1})}),l.on("change",e,function(t){var a,l={video_type:"youtube",video_url:"XDLmLYXuIDM",mp4_url:"",ogv_url:"",webm_url:"",start_time:"",stop_time:"",video_mute:"yes",video_loop:"yes",enable_video_bg:""},i=t.data.find("input[data-css-video-background],select[data-css-video-background]");for(var o in l)"video_mute"==o||"video_loop"==o||"enable_video_bg"==o?e.find('input[name="'+o+'"]').attr("checked")?l[o]="yes":l[o]="":null!==(a=i.filter('[name="'+o+'"]').val())&&void 0!==a&&""!==a&&a!=l[o]&&(l[o]=a);t.data.find("input[data-css-video-background-value]").val(mpl.tools.base64.encode(JSON.stringify(l))).change()});try{i=JSON.parse(mpl.tools.base64.decode(a.value))}catch(e){}i=t.extend({video_type:"youtube",video_url:"XDLmLYXuIDM",mp4_url:"",ogv_url:"",webm_url:"",start_time:"",stop_time:"",video_mute:"yes",video_loop:"yes",enable_video_bg:""},i);for(var o in i)void 0!==i[o]&&("video_mute"==o||"video_loop"==o||"enable_video_bg"==o?"yes"==i[o]||1==i[o]?(l.filter('[name="'+o+'"]').attr({checked:!0}),"enable_video_bg"==o&&e.find(".mpl-control-field").removeClass("mpl-hidden")):(l.filter('[name="'+o+'"]').attr({checked:!1}),"enable_video_bg"==o&&e.find(".mpl-control-field").addClass("mpl-hidden")):"video_type"==o?(l.filter('[name="'+o+'"]').val(i[o]),"html5"==i[o]?(e.find(".mpl-video_url-field").addClass("mpl-hidden"),e.find(".mpl-mp4_url-field").removeClass("mpl-hidden"),e.find(".mpl-ogv_url-field").removeClass("mpl-hidden"),e.find(".mpl-webm_url-field").removeClass("mpl-hidden")):(e.find(".mpl-video_url-field").removeClass("mpl-hidden"),e.find(".mpl-mp4_url-field").addClass("mpl-hidden"),e.find(".mpl-ogv_url-field").addClass("mpl-hidden"),e.find(".mpl-webm_url-field").addClass("mpl-hidden"))):l.filter('[name="'+o+'"]').val(i[o]))},css:function(e,t,a){0===a.options.length&&(a.options=mpl.maps._styling.options),mpl.params.fields.css.render(a,e.find(".mpl-css-rows"));var l=e.closest(".mpl-params-popup");l.data("model");mpl.tools.popup.callback(l,{before_callback:mpl.params.fields.css.save_fields},"field-css-callback")},css_fonts:function(e,t,a){e.find("input").on("focus",function(){var e=t(this).parent().find(".mpl-fonts-list");if(e.html("").show(),"object"==typeof mpl_fonts&&Object.keys(mpl_fonts).length>0){for(var a in mpl_fonts)(a=decodeURIComponent(a))==this.value?e.append("<li style=\"background: #42BCE2;font-family: '"+a+"'\">"+a+"</li>"):e.append("<li style=\"font-family: '"+a+"'\">"+a+"</li>");e.find("li").on("click",function(){t(this).closest(".mpl-fonts-picker").find("input").val(this.innerHTML).change()})}else e.append('<li class="align-center"><h1>\\(^^)/</h1>No fonts in list<br />Add fonts via "Fonts Manager"</li>')}).on("blur",function(){setTimeout(function(e){e.hide()},200,t(this).parent().find(".mpl-fonts-list"))}),e.find("button").on("click",function(e){mpl.ui.lightbox({iframe:!0,url:mpl_site_url+"/wp-admin/admin.php?page=mageewp_page_layout&mpl_action=fonts-manager"}),e.preventDefault()})},radio_image:function(t){t.find(".clear-selected").on("click",t,function(e){e.data.find("input.mpl-param.empty-value").attr({checked:!0}),e.preventDefault()});var a=t.find("img.large-view"),l=e(window).width();t.find("label.rbtn img").on("mouseover mousemove",{el:a,wd:l},function(e){e.data.el.attr("src")!=this.src&&e.data.el.attr("src",this.src),e.data.el.show(),e.data.el.width()!=this.offsetWidth?(e.data.left=e.clientX-e.data.el.width()/2,e.data.left+e.data.el.width()>e.data.wd-10&&(e.data.left=e.data.wd-10-e.data.el.width()),e.data.left<10&&(e.data.left=10),e.data.el.css({display:"block",left:e.data.left+"px",top:e.clientY+20+"px"})):e.data.el.hide()}).on("mouseout",a,function(e){e.data.hide()})},css_border:function(e,t,a){var l=e.find(".multi-fields-ul [data-css-border]"),i=e.find('input[data-css-border="value"]'),o={top:0,right:1,bottom:2,left:3},n=function(){var e=[l.eq(0).val(),l.eq(1).val(),l.eq(2).val()];return""===e[0]||isNaN(e[0])||(e[0]+="px"),e=""!==e[0]&&""!==e[2]?e.join(" "):""},s=function(e){void 0!==e&&""!==e||(e="   "),e=e.trim().split(" "),l.eq(0).val(e[0]),l.eq(1).val(e[1]),e[0]="",e[1]="",e=e.join(" ").trim(),l.eq(2).val(e).css({background:e}).change()};if(l.on("change",function(t){var a=n(),l=i.val(),s=e.find(".active").data("dir");if(void 0===s)l=a;else{l=l.split("|");for(var r=0;r<4;r++)r==o[s]?l[r]=a:void 0===l[r]&&(l[r]="");l=l.join("|")}i.val(l).change()}),e.find(".mpl-corners-pos button,.m-f-u-li-link").on("click",function(a){e.find(".active").removeClass("active"),t(this).addClass("active");var l=i.val().toString().trim().split("|");return void 0===t(this).data("dir")?s(l[0]):1===l.length?(i.val(""),s(l[0])):s(l[o[t(this).data("dir")]]),!1}),e.find(".css-border-advanced").on("click",e,function(e){return e.data.find(".mpl-corners-wrp").removeClass("hidden"),e.data.find(".css-border-advanced").remove(),e.preventDefault(),!1}),-1===a.value.indexOf("|"))e.find(".m-f-u-li-link").addClass("active"),s(a.value);else{e.find(".mpl-corners-wrp").removeClass("hidden"),e.find(".css-border-advanced").remove();for(var r=a.value.split("|"),p=0;p<4;p++)if(void 0!==r[p]&&""!==r[p]){e.find(".mpl-corners-wrp .mpl-corners-pos").eq(p).find("button").trigger("click");break}}e.find("input.m-f-bb-color").each(function(){this.color=new jscolor.color(this,{})})},animate:function(e,t,a){void 0===a.value&&(a.value="");var l=e.find(".mpl-animate-preview"),i=e.find(".mpl-animate-effect"),o=e.find(".mpl-animate-delay"),n=e.find(".mpl-animate-speed"),s=e.find(".mpl-param"),r=a.value.split("|");e.find(".mpl-animate-field select,.mpl-animate-field input").on("change keydown",function(e){void 0!==e.keyCode&&13!==e.keyCode||(""!==o.val()?l.css({"animation-delay":o.val()+"ms"}):l.css({"animation-delay":""}),""!==n.val()?l.css({"animation-duration":n.val()}):l.css({"animation-duration":""}),""!==i.val()&&l.attr({class:""}).attr({class:"mpl-animate-preview animated "+this.value}),s.val(i.val()+"|"+o.val()+"|"+n.val()).change())}),void 0!==r[0]&&""!==r[0]&&i.val(r[0]),void 0!==r[1]&&""!==r[1]&&o.val(r[1]),void 0!==r[2]&&""!==r[2]&&n.val(r[2])},icon_picker:function(e,t,a){e.find("input.mpl-param, .icons-preview").on("click",e.find("input.mpl-param").get(0),function(e){t(".mpl-icons-picker-popup").remove();var a='<div class="icons-list noneuser"><ul class="mpl-icon-picker-tabs mpl-pop-tabs"></ul>'+mpl.tools.get_icons()+"</div>",l=jQuery(a),i={title:"Icon Picker",width:600,class:"no-footer mpl-icons-picker-popup",float:!0,keepCurrentPopups:!0},o=mpl.tools.popup.render(this,i);o.data({target:e.data}),o.find(".m-p-header").append('<input type="search" class="mpl-components-search mpl-icons-search" placeholder="Search by Name"><i class="sl-magnifier"></i>'),o.find(".m-p-body").off("mousedown").on("mousedown",function(e){return e.preventDefault(),!1}),o.find("input.mpl-icons-search").off("keyup").on("keyup",l,function(e){clearTimeout(this.timer),""!==this.value?this.timer=setTimeout(function(a,l){var i;0===l.find(".seach-results").length?(i=t('<div class="seach-results"></div>'),l.prepend(i)):i=l.find(".seach-results");var o=['<span class="label">Search Results:</span>'];l.find(">i").each(function(){this.className.indexOf(a.value.trim())>-1&&o.length<16&&t.inArray(this.className,o)&&o.push('<span data-icon="'+this.className+'"><i class="'+this.className+'"></i>'+this.className+"</span>")}),o.length>1?(i.html(o.join("")),i.find("span").on("click",function(){if(void 0===t(this).data("icon"))return e.preventDefault(),!1;var a=mpl.get.popup(this).data("target");a.value=t(this).data("icon"),t(a).trigger("change"),mpl.get.popup(this,"close").trigger("click")})):i.html('<span class="label">The key you entered was not found.</span>')},150,this,e.data):e.data.find(".seach-results").remove()}).focus(),l.on("click",function(e){if("I"==e.target.tagName){var a=mpl.get.popup(this).data("target");a.value=e.target.title,t(a).trigger("change"),mpl.get.popup(this,"close").trigger("click")}});var n,s=[],r="";l.find("i").each(function(){void 0!==this.className&&this.className.indexOf("-")>-1&&""!==(n=this.className.substr(0,this.className.indexOf("-")).trim())&&-1===s.indexOf(n)&&(s.push(n),r+="<li>"+n+"</li>")}),l.find("ul.mpl-icon-picker-tabs").html(r),l.find("ul.mpl-icon-picker-tabs li").on("click",function(){t(this).parent().find(".active").removeClass("active"),t(this).addClass("active"),l.find("i").hide(),l.find("i[class^='"+this.innerHTML+"-']").css({display:""})}).first().trigger("click"),o.find(".m-p-body").append(l)}).on("change",function(){jQuery(this).parent().find(".icons-preview i").attr({class:this.value})})},wp_widgets:function(e,t){var a=e.find(".mpl-widgets-container"),l=mpl.get.popup(e);a.find("*[data-value]").each(function(){switch(this.tagName){case"INPUT":"radio"==this.type||"checkbox"==this.type?this.checked=!0:this.value=t(this).data("value");break;case"TEXTAREA":this.value=t(this).data("value");break;case"SELECT":var e=t(this).data("value");(e=e?e.toString().split(","):[""]).length>1&&(this.multiple="multiple"),t(this).find("option").each(function(){e.indexOf(this.value)>-1?this.selected=!0:this.selected=!1})}}),mpl.tools.popup.callback(l,{before_callback:function(e){var t=a.data("name"),l=a.closest("form").serializeArray(),i={};i[t]={},l.forEach(function(e){void 0===i[t][e.name]?i[t][e.name]=e.value:i[t][e.name]+=","+e.value});var o=mpl.tools.base64.encode(JSON.stringify(i));a.append('<textarea name="data" class="mpl-param mpl-widget-area forceHide">'+o+"</textarea>")},after_callback:function(e){a.find(".mpl-param.mpl-widget-area.forceHide").remove()}},"field-wp-widget-callback")},optimize_settings:function(t){t.find("input[data-optimized]").on("change",function(){this.checked?mpl_global_optimized[e(this).data("optimized")]=this.value:mpl_global_optimized[e(this).data("optimized")]="";var a=t.closest(".m-p-wrap");0===a.find(".mpl-popup-loading").length&&a.append('<div class="mpl-popup-loading"><span class="mpl-loader"></span></div>'),a.find(".mpl-popup-loading").show(),e.post(mpl_ajax_url,{action:"mpl_enable_optimized",security:mpl_ajax_nonce,settings:mpl_global_optimized,id:e("#post_ID").val()},function(l){t.find(".m-warning, .m-success").remove(),a.find(".mpl-popup-loading").hide(),"-1"==l?(t.find("h1.mgs-t02").after('<div style="display: block" class="m-settings-row m-warning">Error: secure session is invalid. Reload and try again</div>'),e('input[data-optimized="enable"]').attr({checked:!1})):void 0===l.stt?(t.find("h1.mgs-t02").after('<div style="display: block" class="m-settings-row m-warning">Error: unknow reason</div>'),e('input[data-optimized="enable"]').attr({checked:!1})):"0"==l.stt?(t.find("h1.mgs-t02").after('<div style="display: block" class="m-settings-row m-warning">Error: '+l.msg+"</div>"),e('input[data-optimized="enable"]').attr({checked:!1})):(t.find("h1.mgs-t02").after('<div style="display: block" class="m-settings-row m-success">'+l.msg+"</div>"),"on"==mpl_global_optimized.enable?e("#mpl-page-settings").addClass("mpl-optimized-on"):e("#mpl-page-settings").removeClass("mpl-optimized-on"))}).complete(function(e){200!==e.status&&mpl.msg("Please check all of your code and make sure there are no errors. ","error","sl-close")})}),t.find('select[data-optimized="this_page"]').on("change",function(){e("#mpl-page-cfg-optimized").val(this.value),mpl.instant_submit()}),t.find("button.clear-cache").on("click",function(){confirm(mpl.__.i72)&&(mpl_global_optimized.clear_cache="on",t.find("input[data-optimized]").first().trigger("change"))})}}},window.mpl.ui),window.mpl=e.extend({ver:"0",auth:"king-theme.com",model:1,tags:"",storage:[],maps:{},views:{},params:{},tools:{},header:{},mode:"",widgets:null,live_preview:!0,ready:[],objs:{},__:{},_$:null,cfg:{version:0,limitDeleteRestore:10,limitClipboard:9,sectionsPerpage:10,scrollAssistive:1,preventScrollPopup:1,showTips:1,live_preview:!0,columnDoubleContent:"checked",columnKeepContent:"checked",profile:"Mageewp Page Layout",profile_slug:"mageewp-page-layout",sectionsLayout:"grid",mode:"",defaultImg:mpl_plugin_url+"/assets/images/get_start.jpg"},init:function(){"undefined"!=typeof mpl_maps&&(this.tags=shortcode_tags,this.maps=mpl_maps,this.cfg=e().extend(this.cfg,this.backbone.stack.get("MPL_Configs")),mpl.ui.init(),"object"==typeof mpl_js_languages&&(this.__=mpl_js_languages),e("#post_ID").length>0&&""!==e("#post_ID").val()&&(window.mpl_post_id=e("#post_ID").val()),e("#mpl-page-cfg-mode").length>0&&(this.cfg.mode=e("#mpl-page-cfg-mode").val()))},trigger:function(e){var t;for(var a in e.events){if("function"==typeof e.events[a])t=e.events[a];else if("function"==typeof e[e.events[a]])t=e[e.events[a]];else{if("function"!=typeof mpl.backbone[e.events[a]])return!1;t=mpl.backbone[e.events[a]]}1==(a=a.split(":")).length?e.el.off(a[0]).on(a[0],t):e.el.find(a[0]).off(a[1]).on(a[1],e,t)}},template:function(e,t){var a="_"+e;return"exit"==this[a]?null:(void 0===this[a]&&(document.getElementById("tmpl-mpl-"+e+"-template")?this[a]=wp.template("mpl-"+e+"-template"):this[a]=mpl.ui.get_tmpl_cache("tmpl-mpl-"+e+"-template")),void 0===t&&(t={}),"function"==typeof this[a]?this[a](t):null)},get:{model:function(t){var a=e(t).data("model");return void 0!==a&&-1!==a?a:t.parentNode&&"mpl-container"!=t.parentNode.id?this.model(t.parentNode):null},storage:function(e){return mpl.storage[this.model(e)]},section_name:function(t){return e(t).closest(".mpl-elm").attr("class").split(" ")[1].replace(/-/g,"_")},maps:function(e){return mpl.maps[this.storage(e).name]},popup:function(t,a){var l=e(t).closest(".mpl-params-popup");return 0===l.length?null:"close"==a?l.find(".m-p-header .sl-close.sl-func"):"save"==a?l.find(".m-p-header .sl-check.sl-func"):l}},add_action:function(e,t,a){return void 0===this.actions&&(this.actions={}),void 0===this.actions[e]&&(this.actions[e]={}),void 0===this.actions[e][t]&&(this.actions[e][t]=a,!0)},do_action:function(e,t,a,l,i,o){if(void 0===this.actions||void 0===this.actions[e])return!1;for(var n in this.actions[e])"function"==typeof this.actions[e][n]&&this.actions[e][n](t,a,l,i,o);return!0},remove_action:function(e){return void 0!==this.actions&&void 0!==this.actions[e]&&(delete this.actions[e],!0)},delete_action:function(e){return this.remove_action(e)},submit:function(){if(mpl.confirm(!1),e("#mpl-page-cfg-mode").val(mpl.cfg.mode),"mpl"==mpl.cfg.mode){e("#mpl-container").find("form,input,select,textarea").remove();var t="";if(e("#mpl-container > #mpl-rows > .mpl-row").each(function(){var a=mpl.backbone.export(e(this).data("model"));t+=a.begin+a.content+a.end}),""===t)return!1;e("#content").val(t);try{tinyMCE.get("content").setContent(t)}catch(e){}}},instant_submit:function(){if(e("#mpl-page-cfg-mode").val(mpl.cfg.mode),void 0===mpl.curentContentType||"mpl-sections"!=mpl.curentContentType){if(!(e("#mpl-preload").length>0||"mpl"!=mpl.cfg.mode)&&0!==e("#post").length&&0!==e("#title").length&&0!==e("#post_ID").length){mpl.msg(mpl.__.processing,"loading"),document.raw_title=document.title,document.title="Saving...";var t=e(".mpl-params-popup .sl-check.sl-func, .mpl-params-popup .save-post-settings");if(t.length>0)for(var a=t.length-1;a>=0;a--)t.eq(a).trigger("click");var l="",i=e("#post_ID").val(),o=e("#title").val();e("#mpl-container > #mpl-rows > .mpl-row").each(function(){var t=mpl.backbone.export(e(this).data("model"));l+=t.begin+t.content+t.end});var n=mpl.tools.reIndexForm(e("input[name^='mpl_post_meta']").serializeArray(),[]);e.post(mpl_ajax_url,{action:"mpl_instant_save",security:mpl_ajax_nonce,title:o,id:parseInt(i,10),content:l,meta:n.mpl_post_meta},function(t){document.title=document.raw_title,"-1"==t?mpl.msg("Error: secure session is invalid. Reload and try again","error","sl-close"):"-2"==t?mpl.msg("Error: Post not exist","error","sl-close"):"-3"==t?mpl.msg("Error: You do not have permission to edit this post","error","sl-close"):mpl.msg("Successful","success","sl-check"),e("#content").length>0&&(e("#content-html").trigger("click"),e("#content").val(l)),mpl.confirm(!1)}).complete(function(e){document.title=document.raw_title,200!==e.status&&mpl.msg("Your content has been saved, but there seems to be an error occurs. <br />Please check all of your code and make sure there are no errors. ","error","sl-close")})}}else e("#publishing-action button").trigger("click")},msgbox:function(t,a,l){var i=e("#mpl-preload");0===i.length?(i=e('<div id="mpl-preload" style="opacity:0"></div>'),e("body").append(i)):i.html("");var o='<div class="mpl-msgbox-body">'+t+'<ul class="mpl-actions">';o+='<li><button class="button save button-large"><i class="sl-check"></i>Yes</button></li>',o+='<li><button class="button cancel button-large"><i class="sl-close"></i>No</button></li></ul></div>',i.append(o).animate({opacity:1}),e("body").addClass("mpl-ui-blur"),i.find(".button.save").on("click",function(){e("#mpl-preload").remove(),e("body").removeClass("mpl-ui-blur"),void 0!==a&&a(l)}),i.find(".button.cancel").on("click",function(){e("#mpl-preload").remove(),e("body").removeClass("mpl-ui-blur")}),i.on("click",function(t){"mpl-preload"==t.target.id&&(e("#mpl-preload").remove(),e("body").removeClass("mpl-ui-blur"))})},msg:function(t,a,l,i){var o=e("#mpl-preload");if(0===o.length?(o=e('<div id="mpl-preload" style="opacity:0"></div>'),e("body").append(o)):o.html(""),void 0!==l&&""!==l||(l="et-lightbulb"),void 0===a&&(a=""),"loading"==a)e("#mpl-preload").stop().append('<h3 class="mesg '+a+'"><span class="mpl-loader"></span><br />'+t+"</h3>").animate({opacity:1},150);else if("popup"==a){o.append('<div class="mpl-preload-body">'+t+"</div>").animate({opacity:1});var n=e('<a href="#" class="enter close"></a>');o.find(".mpl-preload-body").append(n),e("body").addClass("mpl-ui-blur"),n.on("click",function(){e("#mpl-preload").remove(),e("body").removeClass("mpl-ui-blur")}),o.on("click",function(t){"mpl-preload"==t.target.id&&(e("#mpl-preload").remove(),e("body").removeClass("mpl-ui-blur"))})}else void 0===i&&(i=1500,"error"==a&&(i=1e4)),e("#mpl-preload").stop().append('<h3 class="mesg '+a+'"><i class="'+l+'"></i><br />'+t+"</h3>").animate({opacity:1},150).delay(i).animate({opacity:0},function(){e(this).remove()})},std:function(e,t,a){return"object"!=typeof e?a:void 0!==e[t]&&""!==e[t]?e[t]:a},confirm:function(t){!0===t?window.onbeforeunload=function(){return mpl.__.i01}:(window.onbeforeunload=null,e(window).off("beforeunload"))},id:function(e){return document.getElementById(e)}},window.mpl),e(document).ready(function(){!0===mpl.ui.verify_tmpl()&&mpl.init(),void 0!==window.YoastShortcodePlugin&&void 0!==wpseoShortcodePluginL10n&&void 0!==wpseoShortcodePluginL10n.wpseo_filter_shortcodes_nonce&&(window.YoastShortcodePlugin.prototype.parseShortcodes=function(t,a){var l=e("#content").val(),i="";return t=[],null!==tinymce.activeEditor&&(i+=tinymce.activeEditor.getContent()),mpl.params.process_shortcodes(l,function(e){-1===e.args.content.indexOf("[")&&(i+=e.args.content)},"mpl_column_text"),mpl.params.process_shortcodes(l,function(e){void 0!==e.args.image&&(i+="")},"mpl_single_image"),t.push(i),jQuery.post(ajaxurl,{action:"wpseo_filter_shortcodes",_wpnonce:wpseoShortcodePluginL10n.wpseo_filter_shortcodes_nonce,data:t},function(e){this.saveParsedShortcodes(e,a)}.bind(this))},window.YoastShortcodePlugin.prototype.replaceShortcodes=function(e){var t="";return mpl.params.process_shortcodes(e,function(e){-1===e.args.content.indexOf("[")&&(t+=e.args.content+"\n")},"mpl_column_text"),t})}),void 0===e.fn.shake&&(e.fn.shake=function(){return this.focus().animate({marginLeft:-30},100).animate({marginLeft:20},100).animate({marginLeft:-10},100).animate({marginLeft:5},100).animate({marginLeft:0},100)})}(jQuery);